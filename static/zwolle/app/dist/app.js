angular.module("AmpersandApp",["ngResource","ngRoute","ngSanitize","restangular","ui.bootstrap","uiSwitch","cgBusy","siTable","ng-code-mirror","ngStorage","angularFileUpload","ui.bootstrap.datetimepicker","hc.marked"]).config(["$routeProvider",function(e){e.when("/",{controller:"",templateUrl:"app/src/shared/home.html",interfaceLabel:"Home"}).when("/admin/installer",{controller:"InstallerController",templateUrl:"app/src/admin/installer.html",interfaceLabel:"Installer"}).when("/404",{templateUrl:"app/src/shared/404.html",interfaceLabel:"404"}).otherwise({redirectTo:"/404"})}]).config(["RestangularProvider",function(e){e.setBaseUrl("api/v1"),e.setDefaultHeaders({"Content-Type":"application/json"})}]).run(["Restangular","$rootScope","$location","$route","NotificationService","RoleService","NavigationBarService",function(e,t,r,n,a,o,s){e.addFullRequestInterceptor(function(e,t,r,n,a,o){return o}),e.addResponseInterceptor(function(e,t,n,a,o,i){return"get"!=t&&"getList"!=t&&e.sessionRefreshAdvice&&s.refreshNavBar(),null!=e.navTo&&r.url(e.navTo),e}),e.setErrorInterceptor(function(e,t,n){var s,i;return 401==e.status&&(o.deactivateAllRoles(),r.path("")),"object"==typeof e.data?(404==e.data.error?a.addInfo(e.data.msg||"Resource not found"):(s=e.data.msg||e.statusText,a.addError(s,e.status,!0,e.data.html)),void 0!==e.data.notifications&&a.updateNotifications(e.data.notifications)):(s=e.status+" "+e.statusText,i=e.data,a.addError(s,e.status,!0,i)),!0}),t.getCurrentDateTime=function(){return new Date};var i=r.url;r.url=function(e,a){if(!1===a)var o=n.current,s=t.$on("$locationChangeSuccess",function(){n.current=o,s()});return i.apply(r,[e])}}]).value("cgBusyDefaults",{message:"Loading...",backdrop:!0,minDuration:500}).directive("myShowonhoverBox",function(){return{link:function(e,t,r){t.closest(".box").hasClass("my-showonhover-box-show")||t.hide(),t.closest(".box").bind("mouseenter",function(){t.closest(".box").addClass("my-showonhover-box-show"),t.show()}),t.closest(".box").bind("mouseleave",function(){t.closest(".box").removeClass("my-showonhover-box-show"),t.hide()})}}}).directive("myBluronenter",function(){return function(e,t,r){t.bind("keydown keypress",function(e){13===e.which&&(e.target.blur(),e.preventDefault())})}}).filter("toArray",function(){return function(e,t){return e?Array.isArray(e)?e:!1===t?Object.keys(e).map(function(t){return e[t]}):Object.keys(e).map(function(t){return Object.defineProperty(e[t],"$key",{enumerable:!1,value:t})}):e}}).directive("myNavToInterfaces",function(){return{restrict:"E",scope:{resource:"=",target:"@"},templateUrl:"app/src/shared/partials/myNavToInterfaces.html",transclude:!0}}).directive("myNavToOtherInterfaces",function(){return{restrict:"E",scope:{resource:"=",target:"@"},templateUrl:"app/src/shared/partials/myNavToOtherInterfaces.html"}}).filter("unsafe",["$sce",function(e){return e.trustAsHtml}]);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkFtcGVyc2FuZEFwcC5qcyJdLCJuYW1lcyI6WyJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlnIiwiJHJvdXRlUHJvdmlkZXIiLCJ3aGVuIiwiY29udHJvbGxlciIsInRlbXBsYXRlVXJsIiwiaW50ZXJmYWNlTGFiZWwiLCJvdGhlcndpc2UiLCJyZWRpcmVjdFRvIiwiUmVzdGFuZ3VsYXJQcm92aWRlciIsInNldEJhc2VVcmwiLCJzZXREZWZhdWx0SGVhZGVycyIsIkNvbnRlbnQtVHlwZSIsInJ1biIsIlJlc3Rhbmd1bGFyIiwiJHJvb3RTY29wZSIsIiRsb2NhdGlvbiIsIiRyb3V0ZSIsIk5vdGlmaWNhdGlvblNlcnZpY2UiLCJSb2xlU2VydmljZSIsIk5hdmlnYXRpb25CYXJTZXJ2aWNlIiwiYWRkRnVsbFJlcXVlc3RJbnRlcmNlcHRvciIsImVsZW1lbnQiLCJvcGVyYXRpb24iLCJ3aGF0IiwidXJsIiwiaGVhZGVycyIsInBhcmFtcyIsImFkZFJlc3BvbnNlSW50ZXJjZXB0b3IiLCJkYXRhIiwicmVzcG9uc2UiLCJkZWZlcnJlZCIsInNlc3Npb25SZWZyZXNoQWR2aWNlIiwicmVmcmVzaE5hdkJhciIsIm5hdlRvIiwic2V0RXJyb3JJbnRlcmNlcHRvciIsInJlc3BvbnNlSGFuZGxlciIsIm1lc3NhZ2UiLCJkZXRhaWxzIiwic3RhdHVzIiwiZGVhY3RpdmF0ZUFsbFJvbGVzIiwicGF0aCIsImVycm9yIiwiYWRkSW5mbyIsIm1zZyIsInN0YXR1c1RleHQiLCJhZGRFcnJvciIsImh0bWwiLCJ1bmRlZmluZWQiLCJub3RpZmljYXRpb25zIiwidXBkYXRlTm90aWZpY2F0aW9ucyIsImdldEN1cnJlbnREYXRlVGltZSIsIkRhdGUiLCJvcmlnaW5hbCIsInJlbG9hZCIsImxhc3RSb3V0ZSIsImN1cnJlbnQiLCJ1biIsIiRvbiIsImFwcGx5IiwidmFsdWUiLCJiYWNrZHJvcCIsIm1pbkR1cmF0aW9uIiwiZGlyZWN0aXZlIiwibGluayIsInNjb3BlIiwiYXR0cnMiLCJjbG9zZXN0IiwiaGFzQ2xhc3MiLCJoaWRlIiwiYmluZCIsImFkZENsYXNzIiwic2hvdyIsInJlbW92ZUNsYXNzIiwiZXZlbnQiLCJ3aGljaCIsInRhcmdldCIsImJsdXIiLCJwcmV2ZW50RGVmYXVsdCIsImZpbHRlciIsIm9iaiIsImFkZEtleSIsIkFycmF5IiwiaXNBcnJheSIsIk9iamVjdCIsImtleXMiLCJtYXAiLCJrZXkiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJyZXN0cmljdCIsInJlc291cmNlIiwidHJhbnNjbHVkZSIsIiRzY2UiLCJ0cnVzdEFzSHRtbCJdLCJtYXBwaW5ncyI6IkFBQ0FBLFFBQUFDLE9BQUEsZ0JBQUEsYUFBQSxVQUFBLGFBQUEsY0FBQSxlQUFBLFdBQUEsU0FBQSxVQUFBLGlCQUFBLFlBQUEsb0JBQUEsOEJBQUEsY0FDQUMsUUFBQSxpQkFBQSxTQUFBQyxHQUNBQSxFQUVBQyxLQUFBLEtBQ0FDLFdBQUEsR0FDQUMsWUFBQSwyQkFDQUMsZUFBQSxTQUdBSCxLQUFBLG9CQUNBQyxXQUFBLHNCQUNBQyxZQUFBLCtCQUNBQyxlQUFBLGNBRUFILEtBQUEsUUFDQUUsWUFBQSwwQkFDQUMsZUFBQSxRQUVBQyxXQUFBQyxXQUFBLFlBQ0FQLFFBQUEsc0JBQUEsU0FBQVEsR0FFQUEsRUFBQUMsV0FBQSxVQUNBRCxFQUFBRSxtQkFBQUMsZUFBQSx3QkFHQUMsS0FBQSxjQUFBLGFBQUEsWUFBQSxTQUFBLHNCQUFBLGNBQUEsdUJBQUEsU0FBQUMsRUFBQUMsRUFBQUMsRUFBQUMsRUFBQUMsRUFBQUMsRUFBQUMsR0FFQU4sRUFBQU8sMEJBQUEsU0FBQUMsRUFBQUMsRUFBQUMsRUFBQUMsRUFBQUMsRUFBQUMsR0FHQSxPQUFBQSxJQUdBYixFQUFBYyx1QkFBQSxTQUFBQyxFQUFBTixFQUFBQyxFQUFBQyxFQUFBSyxFQUFBQyxHQUlBLE1BSEEsT0FBQVIsR0FBQSxXQUFBQSxHQUFBTSxFQUFBRyxzQkFBQVosRUFBQWEsZ0JBQ0EsTUFBQUosRUFBQUssT0FBQWxCLEVBQUFTLElBQUFJLEVBQUFLLE9BRUFMLElBR0FmLEVBQUFxQixvQkFBQSxTQUFBTCxFQUFBQyxFQUFBSyxHQU9BLElBQUFDLEVBQ0FDLEVBZ0JBLE9BdEJBLEtBQUFSLEVBQUFTLFNBQ0FwQixFQUFBcUIscUJBQ0F4QixFQUFBeUIsS0FBQSxLQUtBLGlCQUFBWCxFQUFBRCxNQUNBLEtBQUFDLEVBQUFELEtBQUFhLE1BQ0F4QixFQUFBeUIsUUFBQWIsRUFBQUQsS0FBQWUsS0FBQSx1QkFFQVAsRUFBQVAsRUFBQUQsS0FBQWUsS0FBQWQsRUFBQWUsV0FDQTNCLEVBQUE0QixTQUFBVCxFQUFBUCxFQUFBUyxRQUFBLEVBQUFULEVBQUFELEtBQUFrQixZQUdBQyxJQUFBbEIsRUFBQUQsS0FBQW9CLGVBQUEvQixFQUFBZ0Msb0JBQUFwQixFQUFBRCxLQUFBb0IsaUJBRUFaLEVBQUFQLEVBQUFTLE9BQUEsSUFBQVQsRUFBQWUsV0FDQVAsRUFBQVIsRUFBQUQsS0FDQVgsRUFBQTRCLFNBQUFULEVBQUFQLEVBQUFTLFFBQUEsRUFBQUQsS0FHQSxJQUdBdkIsRUFBQW9DLG1CQUFBLFdBQ0EsT0FBQSxJQUFBQyxNQUlBLElBQUFDLEVBQUFyQyxFQUFBUyxJQUNBVCxFQUFBUyxJQUFBLFNBQUFBLEVBQUE2QixHQUNBLElBQUEsSUFBQUEsRUFDQSxJQUFBQyxFQUFBdEMsRUFBQXVDLFFBQ0FDLEVBQUExQyxFQUFBMkMsSUFBQSx5QkFBQSxXQUNBekMsRUFBQXVDLFFBQUFELEVBQ0FFLE1BR0EsT0FBQUosRUFBQU0sTUFBQTNDLEdBQUFTLFFBSUFtQyxNQUFBLGtCQUNBdkIsUUFBQSxhQUNBd0IsVUFBQSxFQUdBQyxZQUFBLE1BRUFDLFVBQUEsbUJBQUEsV0FDQSxPQUNBQyxLQUFBLFNBQUFDLEVBQUEzQyxFQUFBNEMsR0FDQTVDLEVBQUE2QyxRQUFBLFFBQUFDLFNBQUEsNEJBQUE5QyxFQUFBK0MsT0FFQS9DLEVBQUE2QyxRQUFBLFFBQUFHLEtBQUEsYUFBQSxXQUNBaEQsRUFBQTZDLFFBQUEsUUFBQUksU0FBQSwyQkFDQWpELEVBQUFrRCxTQUVBbEQsRUFBQTZDLFFBQUEsUUFBQUcsS0FBQSxhQUFBLFdBQ0FoRCxFQUFBNkMsUUFBQSxRQUFBTSxZQUFBLDJCQUNBbkQsRUFBQStDLGFBSUFOLFVBQUEsZ0JBQUEsV0FDQSxPQUFBLFNBQUFFLEVBQUEzQyxFQUFBNEMsR0FDQTVDLEVBQUFnRCxLQUFBLG1CQUFBLFNBQUFJLEdBQ0EsS0FBQUEsRUFBQUMsUUFDQUQsRUFBQUUsT0FBQUMsT0FFQUgsRUFBQUksdUJBSUFDLE9BQUEsVUFBQSxXQUVBLE9BQUEsU0FBQUMsRUFBQUMsR0FDQSxPQUFBRCxFQUNBRSxNQUFBQyxRQUFBSCxHQUFBQSxHQUNBLElBQUFDLEVBQ0FHLE9BQUFDLEtBQUFMLEdBQUFNLElBQUEsU0FBQUMsR0FDQSxPQUFBUCxFQUFBTyxLQUdBSCxPQUFBQyxLQUFBTCxHQUFBTSxJQUFBLFNBQUFDLEdBQ0EsT0FBQUgsT0FBQUksZUFBQVIsRUFBQU8sR0FBQSxRQUFBRSxZQUFBLEVBQUE3QixNQUFBMkIsTUFSQVAsS0FZQWpCLFVBQUEsb0JBQUEsV0FDQSxPQUNBMkIsU0FBQSxJQUNBekIsT0FBQTBCLFNBQUEsSUFBQWYsT0FBQSxLQUNBdkUsWUFBQSxpREFDQXVGLFlBQUEsS0FFQTdCLFVBQUEseUJBQUEsV0FDQSxPQUNBMkIsU0FBQSxJQUNBekIsT0FBQTBCLFNBQUEsSUFBQWYsT0FBQSxLQUNBdkUsWUFBQSx5REFFQTBFLE9BQUEsVUFBQSxPQUFBLFNBQUFjLEdBQ0EsT0FBQUEsRUFBQUMiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy8gd2hlbiB1c2luZyBtaW5pZmllZCBhbmd1bGFyIG1vZHVsZXMsIHVzZSBtb2R1bGUoJ215QXBwJywgW10pLmNvbnRyb2xsZXIoJ015Q29udHJvbGxlcicsIFsnbXlTZXJ2aWNlJywgZnVuY3Rpb24gKG15U2VydmljZSkgeyAuLi5cclxuYW5ndWxhci5tb2R1bGUoJ0FtcGVyc2FuZEFwcCcsIFsnbmdSZXNvdXJjZScsICduZ1JvdXRlJywgJ25nU2FuaXRpemUnLCAncmVzdGFuZ3VsYXInLCAndWkuYm9vdHN0cmFwJywgJ3VpU3dpdGNoJywgJ2NnQnVzeScsICdzaVRhYmxlJywgJ25nLWNvZGUtbWlycm9yJywgJ25nU3RvcmFnZScsICdhbmd1bGFyRmlsZVVwbG9hZCcsICd1aS5ib290c3RyYXAuZGF0ZXRpbWVwaWNrZXInLCAnaGMubWFya2VkJ10pXHJcbi5jb25maWcoZnVuY3Rpb24oJHJvdXRlUHJvdmlkZXIpIHtcclxuICAgICRyb3V0ZVByb3ZpZGVyXHJcbiAgICAgICAgLy8gZGVmYXVsdCBzdGFydCBwYWdlXHJcbiAgICAgICAgLndoZW4oJy8nLCB7IFxyXG4gICAgICAgICAgICBjb250cm9sbGVyIDogJycsXHJcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsIDogJ2FwcC9zcmMvc2hhcmVkL2hvbWUuaHRtbCcsXHJcbiAgICAgICAgICAgIGludGVyZmFjZUxhYmVsIDogJ0hvbWUnXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgLy8gaW5zdGFsbGVyIHBhZ2VcclxuICAgICAgICAud2hlbignL2FkbWluL2luc3RhbGxlcicsIHtcclxuICAgICAgICAgICAgY29udHJvbGxlciA6ICdJbnN0YWxsZXJDb250cm9sbGVyJyxcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmwgOiAnYXBwL3NyYy9hZG1pbi9pbnN0YWxsZXIuaHRtbCcsXHJcbiAgICAgICAgICAgIGludGVyZmFjZUxhYmVsIDogJ0luc3RhbGxlcidcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAud2hlbignLzQwNCcsIHtcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvc3JjL3NoYXJlZC80MDQuaHRtbCcsXHJcbiAgICAgICAgICAgIGludGVyZmFjZUxhYmVsOiAnNDA0J1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIC5vdGhlcndpc2Uoe3JlZGlyZWN0VG86ICcvNDA0J30pO1xyXG59KS5jb25maWcoZnVuY3Rpb24oUmVzdGFuZ3VsYXJQcm92aWRlcikge1xyXG4gICAgXHJcbiAgICBSZXN0YW5ndWxhclByb3ZpZGVyLnNldEJhc2VVcmwoJ2FwaS92MScpOyAvLyBHZW5lcmF0ZTogcGF0aCB0byBBUEkgZm9sZGVyXHJcbiAgICBSZXN0YW5ndWxhclByb3ZpZGVyLnNldERlZmF1bHRIZWFkZXJzKHtcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIn0pO1xyXG4gICAgLy8gUmVzdGFuZ3VsYXJQcm92aWRlci5zZXRQbGFpbkJ5RGVmYXVsdCh0cnVlKTsgYXZhaWxhYmxlIGZyb20gUmVzdGFuZ3VsYXIgdjEuNS4zXHJcbiAgICBcclxufSkucnVuKGZ1bmN0aW9uKFJlc3Rhbmd1bGFyLCAkcm9vdFNjb3BlLCAkbG9jYXRpb24sICRyb3V0ZSwgTm90aWZpY2F0aW9uU2VydmljZSwgUm9sZVNlcnZpY2UsIE5hdmlnYXRpb25CYXJTZXJ2aWNlKXtcclxuXHJcbiAgICBSZXN0YW5ndWxhci5hZGRGdWxsUmVxdWVzdEludGVyY2VwdG9yKGZ1bmN0aW9uKGVsZW1lbnQsIG9wZXJhdGlvbiwgd2hhdCwgdXJsLCBoZWFkZXJzLCBwYXJhbXMpe1xyXG4gICAgICAgIC8vcGFyYW1zLm5hdklmYyA9IHRydWU7XHJcbiAgICAgICAgLy9wYXJhbXMubWV0YURhdGEgPSB0cnVlO1xyXG4gICAgICAgIHJldHVybiBwYXJhbXM7XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgUmVzdGFuZ3VsYXIuYWRkUmVzcG9uc2VJbnRlcmNlcHRvcihmdW5jdGlvbihkYXRhLCBvcGVyYXRpb24sIHdoYXQsIHVybCwgcmVzcG9uc2UsIGRlZmVycmVkKXtcclxuICAgICAgICBpZihvcGVyYXRpb24gIT0gJ2dldCcgJiYgb3BlcmF0aW9uICE9ICdnZXRMaXN0JyAmJiBkYXRhLnNlc3Npb25SZWZyZXNoQWR2aWNlKSBOYXZpZ2F0aW9uQmFyU2VydmljZS5yZWZyZXNoTmF2QmFyKCk7XHJcblx0XHRpZihkYXRhLm5hdlRvICE9IG51bGwpICRsb2NhdGlvbi51cmwoZGF0YS5uYXZUbyk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIGRhdGE7XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgUmVzdGFuZ3VsYXIuc2V0RXJyb3JJbnRlcmNlcHRvcihmdW5jdGlvbihyZXNwb25zZSwgZGVmZXJyZWQsIHJlc3BvbnNlSGFuZGxlcikge1xyXG4gICAgICAgIC8vIDQwMTogVW5hdXRob3JpemVkXHJcbiAgICAgICAgaWYocmVzcG9uc2Uuc3RhdHVzID09IDQwMSkge1xyXG4gICAgICAgICAgICBSb2xlU2VydmljZS5kZWFjdGl2YXRlQWxsUm9sZXMoKTtcclxuICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJycpOyAvLyBUT0RPOiByZWRpcmVjdCB0byBsb2dpbiBwYWdlIChpZiBleGlzdHMpXHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIHZhciBtZXNzYWdlO1xyXG4gICAgICAgIHZhciBkZXRhaWxzO1xyXG4gICAgICAgIGlmKHR5cGVvZiByZXNwb25zZS5kYXRhID09PSAnb2JqZWN0Jyl7XHJcbiAgICAgICAgICAgIGlmKHJlc3BvbnNlLmRhdGEuZXJyb3IgPT0gNDA0KSB7XHJcbiAgICAgICAgICAgICAgICBOb3RpZmljYXRpb25TZXJ2aWNlLmFkZEluZm8ocmVzcG9uc2UuZGF0YS5tc2cgfHwgJ1Jlc291cmNlIG5vdCBmb3VuZCcpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgbWVzc2FnZSA9IHJlc3BvbnNlLmRhdGEubXNnIHx8IHJlc3BvbnNlLnN0YXR1c1RleHQ7IC8vIGlmIGVtcHR5IHJlc3BvbnNlIG1lc3NhZ2UsIHRha2Ugc3RhdHVzVGV4dFxyXG4gICAgICAgICAgICAgICAgTm90aWZpY2F0aW9uU2VydmljZS5hZGRFcnJvcihtZXNzYWdlLCByZXNwb25zZS5zdGF0dXMsIHRydWUsIHJlc3BvbnNlLmRhdGEuaHRtbCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGlmKHJlc3BvbnNlLmRhdGEubm90aWZpY2F0aW9ucyAhPT0gdW5kZWZpbmVkKSBOb3RpZmljYXRpb25TZXJ2aWNlLnVwZGF0ZU5vdGlmaWNhdGlvbnMocmVzcG9uc2UuZGF0YS5ub3RpZmljYXRpb25zKTsgXHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIG1lc3NhZ2UgPSByZXNwb25zZS5zdGF0dXMgKyAnICcgKyByZXNwb25zZS5zdGF0dXNUZXh0O1xyXG4gICAgICAgICAgICBkZXRhaWxzID0gcmVzcG9uc2UuZGF0YTsgLy8gaHRtbCBjb250ZW50IGlzIGV4Y2VwdGVkXHJcbiAgICAgICAgICAgIE5vdGlmaWNhdGlvblNlcnZpY2UuYWRkRXJyb3IobWVzc2FnZSwgcmVzcG9uc2Uuc3RhdHVzLCB0cnVlLCBkZXRhaWxzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIHRydWU7IC8vIHByb2NlZWQgd2l0aCBzdWNjZXNzIG9yIGVycm9yIGhvb2tzIG9mIHByb21pc2VcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICAkcm9vdFNjb3BlLmdldEN1cnJlbnREYXRlVGltZSA9IGZ1bmN0aW9uICgpe1xyXG4gICAgICAgIHJldHVybiBuZXcgRGF0ZSgpO1xyXG4gICAgfTtcclxuICAgIFxyXG4gICAgLy8gQWRkIGZlYXR1cmUgdG8gJGxvY2F0aW9uLnVybCgpIGZ1bmN0aW9uIHRvIGJlIGFibGUgdG8gcHJldmVudCByZWxvYWRpbmcgcGFnZSAoc2V0IHJlbG9hZCBwYXJhbSB0byBmYWxzZSlcclxuICAgIHZhciBvcmlnaW5hbCA9ICRsb2NhdGlvbi51cmw7XHJcbiAgICAkbG9jYXRpb24udXJsID0gZnVuY3Rpb24gKHVybCwgcmVsb2FkKSB7XHJcbiAgICAgICAgaWYgKHJlbG9hZCA9PT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgdmFyIGxhc3RSb3V0ZSA9ICRyb3V0ZS5jdXJyZW50O1xyXG4gICAgICAgICAgICB2YXIgdW4gPSAkcm9vdFNjb3BlLiRvbignJGxvY2F0aW9uQ2hhbmdlU3VjY2VzcycsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICRyb3V0ZS5jdXJyZW50ID0gbGFzdFJvdXRlO1xyXG4gICAgICAgICAgICAgICAgdW4oKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBvcmlnaW5hbC5hcHBseSgkbG9jYXRpb24sIFt1cmxdKTtcclxuICAgIH07XHJcbiAgICBcclxuICAgIFxyXG59KS52YWx1ZSgnY2dCdXN5RGVmYXVsdHMnLHtcclxuICAgIG1lc3NhZ2U6J0xvYWRpbmcuLi4nLFxyXG4gICAgYmFja2Ryb3A6IHRydWUsXHJcbiAgICAvL3RlbXBsYXRlVXJsOiAnbXlfY3VzdG9tX3RlbXBsYXRlLmh0bWwnLFxyXG4gICAgLy9kZWxheTogNTAwLCAvLyBpbiBtc1xyXG4gICAgbWluRHVyYXRpb246IDUwMCwgLy8gaW4gbXNcclxuICAgIC8vIHdyYXBwZXJDbGFzczogJ215LWNsYXNzIG15LWNsYXNzMidcclxufSkuZGlyZWN0aXZlKCdteVNob3dvbmhvdmVyQm94JywgZnVuY3Rpb24gKCl7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIGxpbmsgOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcclxuICAgICAgICAgICAgaWYoIWVsZW1lbnQuY2xvc2VzdCgnLmJveCcpLmhhc0NsYXNzKCdteS1zaG93b25ob3Zlci1ib3gtc2hvdycpKSBlbGVtZW50LmhpZGUoKTsgLy8gZGVmYXVsdCBoaWRlXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBlbGVtZW50LmNsb3Nlc3QoJy5ib3gnKS5iaW5kKCdtb3VzZWVudGVyJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBlbGVtZW50LmNsb3Nlc3QoJy5ib3gnKS5hZGRDbGFzcygnbXktc2hvd29uaG92ZXItYm94LXNob3cnKTtcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQuc2hvdygpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgZWxlbWVudC5jbG9zZXN0KCcuYm94JykuYmluZCgnbW91c2VsZWF2ZScsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgZWxlbWVudC5jbG9zZXN0KCcuYm94JykucmVtb3ZlQ2xhc3MoJ215LXNob3dvbmhvdmVyLWJveC1zaG93Jyk7XHJcbiAgICAgICAgICAgICAgICBlbGVtZW50LmhpZGUoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufSkuZGlyZWN0aXZlKCdteUJsdXJvbmVudGVyJywgZnVuY3Rpb24oKSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHJzKSB7XHJcbiAgICAgICAgZWxlbWVudC5iaW5kKFwia2V5ZG93biBrZXlwcmVzc1wiLCBmdW5jdGlvbihldmVudCkge1xyXG4gICAgICAgICAgICBpZihldmVudC53aGljaCA9PT0gMTMpIHsgLy8gMTMgPSBDYXJyaWFnZSByZXR1cm5cclxuICAgICAgICAgICAgICAgIGV2ZW50LnRhcmdldC5ibHVyKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxufSkuZmlsdGVyKCd0b0FycmF5JywgZnVuY3Rpb24oKSB7XHJcbiAgICAvLyB1c2VkIGZyb206IGh0dHBzOi8vZ2l0aHViLmNvbS9wZXRlYmFjb25kYXJ3aW4vYW5ndWxhci10b0FycmF5RmlsdGVyXHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKG9iaiwgYWRkS2V5KSB7XHJcbiAgICAgICAgaWYgKCFvYmopIHJldHVybiBvYmo7XHJcbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkob2JqKSkgcmV0dXJuIG9iajsgLy8gb2JqIGlzIGFscmVhZHkgYW4gYXJyYXlcclxuICAgICAgICBpZiAoIGFkZEtleSA9PT0gZmFsc2UgKSB7XHJcbiAgICAgICAgICByZXR1cm4gT2JqZWN0LmtleXMob2JqKS5tYXAoZnVuY3Rpb24oa2V5KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBvYmpba2V5XTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICByZXR1cm4gT2JqZWN0LmtleXMob2JqKS5tYXAoZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgICAgICByZXR1cm4gT2JqZWN0LmRlZmluZVByb3BlcnR5KG9ialtrZXldLCAnJGtleScsIHsgZW51bWVyYWJsZTogZmFsc2UsIHZhbHVlOiBrZXl9KTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfTtcclxufSkuZGlyZWN0aXZlKCdteU5hdlRvSW50ZXJmYWNlcycsIGZ1bmN0aW9uKCl7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIHJlc3RyaWN0IDogJ0UnLFxyXG4gICAgICAgIHNjb3BlIDoge3Jlc291cmNlIDogJz0nLCB0YXJnZXQgOiAnQCd9LCAvLyAnPScgPT4gdHdvLXdheSBiaW5kLCAnQCcgPT4gZXZhbHVhdGVzIHN0cmluZyAodXNlIHt7fX0gaW4gaHRtbCkgXHJcbiAgICAgICAgdGVtcGxhdGVVcmwgOiAnYXBwL3NyYy9zaGFyZWQvcGFydGlhbHMvbXlOYXZUb0ludGVyZmFjZXMuaHRtbCcsXHJcbiAgICAgICAgdHJhbnNjbHVkZSA6IHRydWVcclxuICAgIH07XHJcbn0pLmRpcmVjdGl2ZSgnbXlOYXZUb090aGVySW50ZXJmYWNlcycsIGZ1bmN0aW9uKCl7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIHJlc3RyaWN0IDogJ0UnLFxyXG4gICAgICAgIHNjb3BlICA6IHtyZXNvdXJjZSA6ICc9JywgdGFyZ2V0IDogJ0AnfSwgLy8gJz0nID0+IHR3by13YXkgYmluZCwgJ0AnID0+IGV2YWx1YXRlcyBzdHJpbmcgKHVzZSB7e319IGluIGh0bWwpIFxyXG4gICAgICAgIHRlbXBsYXRlVXJsIDogJ2FwcC9zcmMvc2hhcmVkL3BhcnRpYWxzL215TmF2VG9PdGhlckludGVyZmFjZXMuaHRtbCdcclxuICAgIH07XHJcbn0pLmZpbHRlcigndW5zYWZlJywgZnVuY3Rpb24oJHNjZSl7XHJcbiAgICByZXR1cm4gJHNjZS50cnVzdEFzSHRtbDtcclxufSk7Il19
