{"version":3,"sources":["module.js","angular-ui-switch/angular-ui-switch-adapted.js","admin/execengine.controller.js","admin/installer.controller.js","importer/importer.module.js","interfacing/atomic.controller.js","interfacing/atomicDate.controller.js","interfacing/atomicTypeAhead.controller.js","interfacing/atomicUploadFile.controller.js","interfacing/box.controller.js","interfacing/interface.controller.js","interfacing/myBluronenter.directive.js","interfacing/myShowonooverBox.directive.js","interfacing/resource.service.js","navbar/myNavbarResize.directive.js","navbar/navigationBar.controller.js","navbar/navigationBar.service.js","navbar/role.service.js","notifications/notification.service.js","notifications/notificationCenter.controller.js","notifications/unsafe.filter.js","shared/myNavTo/myNavToInterfaces.directive.js","shared/myNavTo/myNavToOtherInterfaces.directive.js","shared/loading/cgBusyDefaults.value.js","ampersand.js","templates.js"],"names":["angular","module","config","$routeProvider","$locationProvider","when","controller","templateUrl","interfaceLabel","otherwise","redirectTo","hashPrefix","RestangularProvider","setBaseUrl","setDefaultHeaders","Content-Type","run","Restangular","$rootScope","$location","$route","NotificationService","RoleService","NavigationBarService","addFullRequestInterceptor","element","operation","what","url","headers","params","addResponseInterceptor","data","response","deferred","sessionRefreshAdvice","refreshNavBar","navTo","setErrorInterceptor","responseHandler","message","details","status","deactivateAllRoles","path","error","addInfo","msg","statusText","addError","html","undefined","notifications","updateNotifications","getCurrentDateTime","Date","original","reload","lastRoute","current","un","$on","apply","directive","restrict","replace","transclude","template","attrs","ngModel","ngClick","class","$scope","one","get","then","plain","installing","installed","install","defPop","defaultPop","app","requires","length","service","FileUploader","uploader","onSuccessItem","fileItem","onErrorItem","item","ImportService","ResourceService","selected","saveItem","addItem","removeItem","remove","removeResource","delete","deleteResource","pad","number","r","String","modifyToJSON","obj","toJSON","this","getUTCFullYear","getMonth","getDate","isOpen","openDatepicker","$event","preventDefault","stopPropagation","value","saveDateItem","property","patchResource","addDateItem","console","log","hasNoResults","getTypeahead","resourceType","forceGetCall","typeahead","all","getList","$object","typeaheadOnSelect","$item","$model","$label","resource","ifc","_id_","Array","isArray","patch","createPatch","addPatches","saved","push","copy","typeAheadCreate","alias","formData","removeAfterUpload","autoUpload","content","code","createResource","save","saveResource","cancel","cancelResource","event","next","checkRequired","confirmed","confirm","emptyUpdatedResources","newResource","ifcName","pendingPromises","scope","bind","which","target","blur","link","closest","hasClass","hide","addClass","show","removeClass","$localStorage","$timeout","$q","updatedResources","getResource","callingObj","promise","_path_","$","isEmptyObject","extend","initResourceMetaData","_loading_","_patchesCache_","_isRoot_","processResponse","getNotifications","prepend","post","unshift","parent","splice","indexOf","reject","index","pathLength","substring","op","patches","concat","switchAutoSave","setResourceStatus","_showButtons_","resolve","reduce","prev","arr","invariantRulesHold","_status_","warning","danger","default","success","some","val","$$state","$window","w","resizeNavbar","width","children","first","appendTo","last","prependTo","toggleClass","$watch","$sessionStorage","$storage","defaultSettings","loadingNavBar","navbar","toggleRole","roleId","set","setActiveRoles","checkAllRules","createNewResource","openWithIfc","resetSettings","forEach","notificationPrefs","resetNotificationSettings","resetSwitchAutoSave","session","sessionRoles","sessionVars","selectRole","selectRoleByLabel","roleLabel","role","label","id","active","getActiveRoleIds","roleIds","signals","invariants","infos","successes","warnings","errors","addSuccess","switchAutoHideSuccesses","count","persistent","alreadyExists","i","addWarning","localStorage","filter","closeAlert","alerts","$sce","trustAsHtml","backdrop","minDuration","$templateCache","put"],"mappings":"AACAA,QAAAC,OAAA,gBAAA,aAAA,UAAA,aAAA,cAAA,eAAA,WAAA,SAAA,UAAA,gBAAA,YAAA,oBAAA,8BAAA,cACAC,QAAA,iBAAA,oBAAA,SAAAC,EAAAC,GACAD,EAEAE,KAAA,KACAC,WAAA,GACAC,YAAA,2BACAC,eAAA,SAGAH,KAAA,oBACAC,WAAA,sBACAC,YAAA,+BACAC,eAAA,cAEAH,KAAA,QACAE,YAAA,0BACAC,eAAA,QAEAC,WAAAC,WAAA,SAEAN,EAAAO,WAAA,OACAT,QAAA,sBAAA,SAAAU,GAEAA,EAAAC,WAAA,UACAD,EAAAE,mBAAAC,eAAA,wBAGAC,KAAA,cAAA,aAAA,YAAA,SAAA,sBAAA,cAAA,uBAAA,SAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,GAEAN,EAAAO,0BAAA,SAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,GAGA,OAAAA,IAGAb,EAAAc,uBAAA,SAAAC,EAAAN,EAAAC,EAAAC,EAAAK,EAAAC,GAIA,MAHA,OAAAR,GAAA,WAAAA,GAAAM,EAAAG,sBAAAZ,EAAAa,gBACA,OAAAJ,OAAAK,OAAAlB,EAAAS,IAAAI,EAAAK,OAEAL,IAGAf,EAAAqB,oBAAA,SAAAL,EAAAC,EAAAK,GAOA,IAAAC,EACAC,EAgBA,OAtBA,KAAAR,EAAAS,SACApB,EAAAqB,qBACAxB,EAAAyB,KAAA,KAKA,iBAAAX,EAAAD,MACA,KAAAC,EAAAD,KAAAa,MACAxB,EAAAyB,QAAAb,EAAAD,KAAAe,KAAA,uBAEAP,EAAAP,EAAAD,KAAAe,KAAAd,EAAAe,WACA3B,EAAA4B,SAAAT,EAAAP,EAAAS,QAAA,EAAAT,EAAAD,KAAAkB,YAGAC,IAAAlB,EAAAD,KAAAoB,eAAA/B,EAAAgC,oBAAApB,EAAAD,KAAAoB,iBAEAZ,EAAAP,EAAAS,OAAA,IAAAT,EAAAe,WACAP,EAAAR,EAAAD,KACAX,EAAA4B,SAAAT,EAAAP,EAAAS,QAAA,EAAAD,KAGA,IAGAvB,EAAAoC,mBAAA,WACA,OAAA,IAAAC,MAIA,IAAAC,EAAArC,EAAAS,IACAT,EAAAS,IAAA,SAAAA,EAAA6B,GACA,IAAA,IAAAA,EACA,IAAAC,EAAAtC,EAAAuC,QACAC,EAAA1C,EAAA2C,IAAA,yBAAA,WACAzC,EAAAuC,QAAAD,EACAE,MAGA,OAAAJ,EAAAM,MAAA3C,GAAAS,QCrFA5B,QAAAC,OAAA,eAEA8D,UAAA,SAAA,WACA,OACAC,SAAA,KACAC,SAAA,EACAC,YAAA,EACAC,SAAA,SAAA1C,EAAA2C,GACA,IAAAlB,EAAA,GAYA,OAXAA,GAAA,aACAA,GAAAkB,EAAAC,UAAAD,EAAAE,QAAA,cAAAF,EAAAC,QAAA,KAAAD,EAAAC,QAAA,IAAA,GACAnB,GAAA,IACAA,GAAA,QACAA,GAAA,kBAAAkB,EAAAG,MAAA,IAAAH,EAAAG,MAAA,IAAA,IACArB,GAAA,wBAAAkB,EAAAC,QAAA,MACAnB,GAAA,IACAA,GAAA,kBACAA,GAAA,UACAA,GAAA,8BACAA,GAAA,WClBAlD,QAAAC,OAAA,gBACAK,WAAA,wBAAA,SAAA,cAAA,sBAAA,SAAAkE,EAAAvD,EAAAI,GACAmD,EAAAxD,IAAA,WACAC,EAAAwD,IAAA,wBAAAC,MACAC,KACA,SAAA3C,GACAA,EAAAA,EAAA4C,QACAvD,EAAAgC,oBAAArB,SCRAhC,QAAAC,OAAA,gBACAK,WAAA,uBAAA,SAAA,cAAA,sBAAA,cAAA,SAAAkE,EAAAvD,EAAAI,EAAAC,GACAkD,EAAAK,YAAA,EACAL,EAAAM,WAAA,EAEAN,EAAAO,QAAA,SAAAC,GACAR,EAAAK,YAAA,EACAL,EAAAM,WAAA,EACA7D,EAAAwD,IAAA,mBAAAC,KAAAO,WAAAD,IAAAL,KAAA,SAAA3C,GACAA,EAAAA,EAAA4C,QACAvD,EAAAgC,oBAAArB,GAGAV,EAAAqB,qBAEA6B,EAAAK,YAAA,EACAL,EAAAM,WAAA,GACA,WACAN,EAAAK,YAAA,EACAL,EAAAM,WAAA,QCnBA,IAAAI,IAAAlF,QAAAC,OAAA,gBACAiF,IAAAC,SAAAD,IAAAC,SAAAC,QAAA,oBACAF,IAAAhF,QAAA,iBAAA,SAAAC,GACAA,EACAE,KAAA,iBACAC,WAAA,6BACAC,YAAA,iCACAC,eAAA,2BAEA6E,QAAA,iBAAA,eAAA,sBAAA,SAAAC,EAAAjE,GACA,IAAAkE,EAAA,IAAAD,GACA1D,IAAA,wBAsBA,OAnBA2D,EAAAC,cAAA,SAAAC,EAAAxD,EAAAS,EAAAb,GACAR,EAAAgC,oBAAApB,EAAAmB,gBAGAmC,EAAAG,YAAA,SAAAC,EAAA1D,EAAAS,EAAAb,GACA,IAAAW,EACAC,EACA,iBAAAR,GACAO,EAAAP,EAAAc,KAAA,wBACA1B,EAAA4B,SAAAT,EAAAE,GAAA,QAEAS,IAAAlB,EAAAmB,eAAA/B,EAAAgC,oBAAApB,EAAAmB,iBAEAZ,EAAAE,EAAA,yBACAD,EAAAR,EACAZ,EAAA4B,SAAAT,EAAAE,GAAA,EAAAD,MAIA8C,SAAAA,MACAjF,WAAA,8BAAA,SAAA,gBAAA,SAAAkE,EAAAoB,GACApB,EAAAe,SAAAK,EAAAL,YCnCAvF,QAAAC,OAAA,gBACAK,WAAA,oBAAA,SAAA,kBAAA,SAAAkE,EAAAqB,GAMArB,EAAAsB,YAEAtB,EAAAuB,SAAAF,EAAAE,SAEAvB,EAAAwB,QAAAH,EAAAG,QAEAxB,EAAAyB,WAAAJ,EAAAI,WAEAzB,EAAA0B,OAAAL,EAAAM,eAEA3B,EAAA4B,OAAAP,EAAAQ,kBCjBArG,QAAAC,OAAA,gBACAK,WAAA,wBAAA,SAAA,kBAAA,SAAAkE,EAAAqB,GAWA,SAAAS,EAAAC,GACA,IAAAC,EAAAC,OAAAF,GAIA,OAHA,IAAAC,EAAApB,SACAoB,EAAA,IAAAA,GAEAA,EAGA,SAAAE,EAAAC,GACA,OAAAA,IACAA,EAAAC,OAAA,WACA,OAAAC,KAAAC,iBACA,IAAAR,EAAAO,KAAAE,WAAA,GACA,IAAAT,EAAAO,KAAAG,aAtBAxC,EAAAyC,QAAA,EAEAzC,EAAA0C,eAAA,SAAAC,GACAA,EAAAC,iBACAD,EAAAE,kBACA7C,EAAAyC,QAAA,GAsBAzC,EAAAsB,UAAAwB,MAAA,IAEA9C,EAAA+C,aAAA,SAAAZ,EAAAa,EAAAC,GACAf,EAAAC,EAAAa,IACA3B,EAAAE,SAAAY,EAAAa,EAAAC,IAGAjD,EAAAkD,YAAA,SAAAf,EAAAa,EAAA1B,EAAA2B,GACA,KAAA3B,EAAAwB,OACAZ,EAAAZ,EAAAwB,OACAzB,EAAAG,QAAAW,EAAAa,EAAA1B,EAAA2B,IAEAE,QAAAC,IAAA,2BC1CA5H,QAAAC,OAAA,gBACAK,WAAA,6BAAA,SAAA,cAAA,kBAAA,SAAAkE,EAAAvD,EAAA4E,GAMArB,EAAAsB,YAEAtB,EAAAqD,cAAA,EAYArD,EAAAsD,aAAA,SAAAC,EAAAC,GACAA,OAAA,IAAAA,GAAAA,QAGA,IAAAxD,EAAAyD,UAAAF,IAAAC,KACAxD,EAAAyD,UAAAF,GAAA9G,EAAAiH,IAAA,YAAAH,GAAAI,UAAAC,UAIA5D,EAAA6D,kBAAA,SAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAjB,QACA,IAAAa,EAAAK,KAAAhB,QAAAC,IAAA,yBACA,KAAAU,EAAAK,KAAAhB,QAAAC,IAAA,+BAEAgB,MAAAC,QAAAJ,EAAAC,KAEAI,MAAAjD,EAAAkD,YAAA,MAAAN,EAAAhB,EAAAiB,EAAAJ,EAAAK,MACA9C,EAAAmD,WAAAvB,GAAAqB,QACAnE,KAAA,SAAA3C,GAEAA,EAAAiH,OAAAR,EAAAC,GAAAQ,KAAAlJ,QAAAmJ,KAAAb,OAGA,OAAAG,EAAAC,IAEAI,MAAAjD,EAAAkD,YAAA,UAAAN,EAAAhB,EAAAiB,EAAAJ,EAAAK,MACA9C,EAAAmD,WAAAvB,GAAAqB,QACAnE,KAAA,SAAA3C,GAEAA,EAAAiH,QAAAR,EAAAC,GAAA1I,QAAAmJ,KAAAb,OAGAX,QAAAC,IAAA,kDAEApD,EAAAqD,cAAA,GAGArD,EAAAsB,SAAAwB,MAAA,IAGA9C,EAAA4E,gBAAA,SAAAX,EAAAC,EAAA5C,EAAA2B,EAAAM,GACAa,MAAAC,QAAAJ,EAAAC,IACA7C,EAAAG,QAAAyC,EAAAC,EAAA5C,EAAA2B,GAAA9C,KACA,WACAH,EAAAsD,aAAAC,GAAA,KAGA,OAAAU,EAAAC,IACAD,EAAAC,GAAA5C,EAAAwB,MACAzB,EAAAE,SAAA0C,EAAAC,EAAAjB,IAEAE,QAAAC,IAAA,sDCvEA5H,QAAAC,OAAA,gBACAK,WAAA,8BAAA,SAAA,eAAA,sBAAA,SAAAkE,EAAAc,EAAAjE,GAGAmD,EAAAc,aAAA,IAAAA,GACA+D,MAAA,OACAC,YACAC,mBAAA,EACAC,YAAA,IAGAhF,EAAAc,aAAAE,cAAA,SAAAC,EAAAxD,EAAAS,EAAAb,GACAR,EAAAgC,oBAAApB,EAAAmB,eAGAqC,EAAAgD,SAAAhD,EAAAiD,KAAAQ,KAAAjH,EAAAwH,UAGAjF,EAAAc,aAAAI,YAAA,SAAAC,EAAA1D,EAAAS,EAAAb,GACAR,EAAA4B,SAAAhB,EAAAY,MAAAL,QAAAP,EAAAY,MAAA6G,MAAA,OCnBA1J,QAAAC,OAAA,gBACAK,WAAA,iBAAA,SAAA,kBAAA,SAAAkE,EAAAqB,GAGArB,EAAAmF,eAAA9D,EAAA8D,eAGAnF,EAAAoF,KAAA/D,EAAAgE,aAGArF,EAAAsF,OAAAjE,EAAAkE,eAGAvF,EAAA0B,OAAAL,EAAAM,eAGA3B,EAAA4B,OAAAP,EAAAQ,kBChBArG,QAAAC,OAAA,gBACAK,WAAA,uBAAA,SAAA,YAAA,kBAAA,SAAAkE,EAAArD,EAAA0E,GAMArB,EAAAyD,aAGAzD,EAAAX,IAAA,uBAAA,SAAAmG,EAAAC,EAAAtG,GACAkC,EAAAqE,kBACAC,UAAAC,QAAA,iDACAJ,IAAAG,UAAAH,EAAA5C,iBACA4C,GAAAG,UAAAtE,EAAAwE,wBACA1C,QAAAC,IAAA,6EAKApD,EAAA8F,YAAA,WACAnJ,EAAAS,IAAA,IAAA2I,QAAA,SAIA/F,EAAAgG,gBAAA3E,EAAA2E,mBCzBAxK,QAAAC,OAAA,gBACA8D,UAAA,gBAAA,WACA,OAAA,SAAA0G,EAAAhJ,EAAA2C,GACA3C,EAAAiJ,KAAA,mBAAA,SAAAV,GACA,KAAAA,EAAAW,QACAX,EAAAY,OAAAC,OAEAb,EAAA5C,uBCPApH,QAAAC,OAAA,gBACA8D,UAAA,mBAAA,WACA,OACA+G,KAAA,SAAAL,EAAAhJ,EAAA2C,GACA3C,EAAAsJ,QAAA,QAAAC,SAAA,4BAAAvJ,EAAAwJ,OAEAxJ,EAAAsJ,QAAA,QAAAL,KAAA,aAAA,WACAjJ,EAAAsJ,QAAA,QAAAG,SAAA,2BACAzJ,EAAA0J,SAEA1J,EAAAsJ,QAAA,QAAAL,KAAA,aAAA,WACAjJ,EAAAsJ,QAAA,QAAAK,YAAA,2BACA3J,EAAAwJ,aCZAjL,QAAAC,OAAA,gBACAoF,QAAA,mBAAA,gBAAA,WAAA,YAAA,cAAA,sBAAA,KAAA,SAAAgG,EAAAC,EAAAnK,EAAAF,EAAAI,EAAAkK,GAGA,IAAAC,KAEA3F,GASA4F,YAAA,SAAAhD,EAAAC,EAAAgD,GAqBA,OApBAC,QAAA1K,EACAwD,IAAAgE,EAAAmD,OAAA,IAAAlD,GACAhE,MACAC,KAAA,SAAA3C,GACA,IACAA,EAAAA,EAAA4C,QACA,MAAA/B,IAOA,OANAgJ,EAAAC,cAAA9J,GAAAX,EAAAyB,QAAA,oBACA,OAAA2F,EAAAC,IAAAE,MAAAC,QAAAJ,EAAAC,IAAAD,EAAAC,GAAA1G,EACAhC,QAAA+L,OAAAtD,EAAAC,GAAA1G,GAEA6D,EAAAmG,qBAAAvD,GAEAA,IAIAG,MAAAC,QAAA6C,EAAAO,aAAAP,EAAAO,cACAP,EAAAO,UAAA/C,KAAAyC,SAEAA,SASA9B,aAAA,SAAApB,GAqBA,OApBAkD,QAAA1K,EACAwD,IAAAgE,EAAAmD,QACA9C,MAAAL,EAAAyD,mBACAvH,KAAA,SAAA3C,GAUA,OATAA,EAAAA,EAAA4C,QAGA6D,EAAA0D,SAAA1D,EAAA/D,MACA+D,EAAAzI,QAAA+L,OAAAtD,EAAAzG,EAAAyH,SAGA5D,EAAAuG,gBAAA3D,EAAAzG,IAEAyG,SAAAA,EAAAQ,OAAA,KAIAL,MAAAC,QAAAJ,EAAAwD,aAAAxD,EAAAwD,cACAxD,EAAAwD,UAAA/C,KAAAyC,SAEAA,SASA5B,eAAA,SAAAtB,GAoBA,OAnBAkD,QAAA1K,EACAwD,IAAAgE,EAAAmD,QACAlH,MACAC,KAAA,SAAA3C,GASA,OARAA,EAAAA,EAAA4C,QACAiH,EAAAC,cAAA9J,GAAAX,EAAAyB,QAAA,oBACA9C,QAAA+L,OAAAtD,EAAAzG,GAGAX,EAAAgL,mBACAxG,EAAAmG,qBAAAvD,GAEAA,IAIAG,MAAAC,QAAAJ,EAAAwD,aAAAxD,EAAAwD,cACAxD,EAAAwD,UAAA/C,KAAAyC,SAEAA,SAYAhC,eAAA,SAAAlB,EAAAC,EAAAgD,EAAAY,GA8BA,MA7BA,cAAAA,IAAAA,GAAA,GAEAX,QAAA1K,EACAwD,IAAAgE,EAAAmD,QAAA1D,IAAAQ,GACA6D,YACA5H,KAAA,SAAA3C,GAiBA,OAhBAA,EAAAA,EAAA4C,QAEAiB,EAAAuG,gBAAAV,EAAA1J,GAEAsI,YAAAtI,EAAAyH,QAGAb,MAAAC,QAAAJ,EAAAC,IACA4D,EAAA7D,EAAAC,GAAA8D,QAAAlC,aACA7B,EAAAC,GAAAQ,KAAAoB,aAEA7B,EAAAC,GAAA4B,YAGA7B,EAAA0D,UAAA,QAAA1D,EAAAE,MAAAxH,EAAAS,IAAA,IAAA8G,EAAA,IAAA4B,YAAA3B,MAAA,GAEA2B,cAIA1B,MAAAC,QAAA6C,EAAAO,aAAAP,EAAAO,cACAP,EAAAO,UAAA/C,KAAAyC,SAEAA,SAYAxF,eAAA,SAAAsG,EAAA/D,EAAAD,EAAAhB,GAKA,OAHAqB,MAAAjD,EAAAkD,YAAA,SAAAN,EAAAhB,GAGA5B,EACAmD,WAAAvB,GAAAqB,QACAnE,KAAA,SAAA3C,GAEA4G,MAAAC,QAAA4D,EAAA/D,IAAA+D,EAAA/D,GAAAgE,OAAAD,EAAA/D,GAAAiE,QAAAlE,GAAA,GACAgE,EAAA/D,GAAA,QAYArC,eAAA,SAAAoG,EAAA/D,EAAAD,GACA,GAAA2B,QAAA,iBAoBA,OAnBAuB,QAAA1K,EACAwD,IAAAgE,EAAAmD,QACA1F,WACAvB,KAAA,SAAA3C,GASA,OARAA,EAAAA,EAAA4C,QAEAvD,EAAAgC,oBAAArB,EAAAoB,eAGAwF,MAAAC,QAAA4D,EAAA/D,IAAA+D,EAAA/D,GAAAgE,OAAAD,EAAA/D,GAAAiE,QAAAlE,GAAA,GACAgE,EAAA/D,GAAA,KAEA+D,IAIA7D,MAAAC,QAAAJ,EAAAwD,aAAAxD,EAAAwD,cACAxD,EAAAwD,UAAA/C,KAAAyC,SAEAA,SAYA5F,SAAA,SAAA0C,EAAAC,EAAAjB,GAUA,YARA,IAAAgB,EAAAC,IAAA,KAAAD,EAAAC,GACApB,MAAA,KAEAA,MAAAmB,EAAAC,GAEAI,MAAAjD,EAAAkD,YAAA,UAAAN,EAAAhB,EAAAiB,EAAApB,OAGAzB,EAAAmD,WAAAvB,GAAAqB,SAYA9C,QAAA,SAAAyC,EAAAC,EAAA5C,EAAA2B,GACA,YAAA,IAAA3B,EAAAwB,MAEAiE,EAAAqB,OAAA,mBACA,KAAA9G,EAAAwB,MAEAiE,EAAAqB,OAAA,wBACAhE,MAAAC,QAAAJ,EAAAC,KAKAD,EAAAC,GAAAQ,KAAApD,EAAAwB,OAGAwB,MAAAjD,EAAAkD,YAAA,MAAAN,EAAAhB,EAAAiB,EAAA5C,EAAAwB,OACAzB,EAAAmD,WAAAvB,GAAAqB,QAAAnE,KAAA,SAAA3C,GAGA,cADA8D,EAAA,MACA9D,KAVAuJ,EAAAqB,OAAA,2CAwBA3G,WAAA,SAAAwC,EAAAC,EAAAmE,EAAApF,GAQA,OANAH,MAAAmB,EAAAC,GAAAmE,GACA/D,MAAAjD,EAAAkD,YAAA,SAAAN,EAAAhB,EAAAiB,EAAApB,OAGAmB,EAAAC,GAAAgE,OAAAG,EAAA,GAEAhH,EAAAmD,WAAAvB,GAAAqB,SAaAC,YAAA,SAAArH,EAAA+G,EAAAhB,EAAAiB,EAAApB,GAOA,YANA,IAAAG,IAAAA,EAAAgB,GACAqE,WAAArF,EAAAmE,OAAAxG,OAEAxC,KAAA6F,EAAAmD,OAAAmB,UAAAD,iBACA,IAAApE,IAAA9F,KAAAA,KAAA,IAAA8F,QAEA,IAAApB,GAAA0F,GAAAtL,EAAAkB,KAAAA,OACAoK,GAAAtL,EAAAkB,KAAAA,KAAA0E,MAAAA,IAUA0B,WAAA,SAAAP,EAAAwE,GASA,OAPArE,MAAAC,QAAAJ,EAAAyD,kBAAAzD,EAAAyD,mBACAzD,EAAAyD,eAAAzD,EAAAyD,eAAAgB,OAAAD,IAGA,IAAAzB,EAAAmB,QAAAlE,IAAA+C,EAAAtC,KAAAT,GAGA4C,EAAA8B,eACAtH,EAAAgE,aAAApB,IAGA5C,EAAAuH,kBAAA3E,EAAA,WACAA,EAAA4E,eAAAzD,MAAA,EAAAE,QAAA,GACAyB,EAAA+B,SAAA7E,SAAAA,EAAAQ,OAAA,MASAiB,cAAA,WACAsB,EAAA+B,OAAA,SAAAC,EAAA7H,EAAAkH,EAAAY,GACA,OAAAD,GAAA7H,EAAAuG,eAAA9G,SACA,IAMAiF,sBAAA,WACAmB,MAQAQ,qBAAA,SAAAvD,GACAA,EAAA4E,eAAAzD,MAAA,EAAAE,QAAA,GACArB,EAAAyD,kBACArG,EAAAuH,kBAAA3E,EAAA,YAUA2D,gBAAA,SAAA3D,EAAAxG,GAiBA,OAhBAZ,EAAAgC,oBAAApB,EAAAmB,eAEAnB,EAAAyL,oBACAjF,EAAA4E,eAAAzD,MAAA,EAAAE,QAAA,GACArB,EAAAyD,kBACArG,EAAAuH,kBAAA3E,EAAA,WAGA6C,EAAA,WACAzF,EAAAuH,kBAAA3E,EAAA,YACA,OAEAA,EAAA4E,eAAAzD,MAAA,EAAAE,QAAA,GACAjE,EAAAuH,kBAAA3E,EAAA,WAGAA,GAUA2E,kBAAA,SAAA3E,EAAA/F,GAUA,OARA+F,EAAAkF,UAAAC,SAAA,EACAC,QAAA,EACAC,SAAA,EACAC,SAAA,GAGAtF,EAAAkF,SAAAjL,IAAA,EAEA+F,GASA+B,gBAAA,SAAA/B,GACA,QAAAG,MAAAC,QAAAJ,EAAAwD,YAEAxD,EAAAwD,UAAA+B,KAAA,SAAAC,GACA,OAAA,IAAAA,EAAAC,QAAAxL,WAKA,OAAAmD,KCxZA7F,QAAAC,OAAA,gBACA8D,UAAA,kBAAA,UAAA,WAAA,uBAAA,SAAAoK,EAAA7C,EAAA/J,GACA,OAAA,SAAAkJ,EAAAhJ,GACA,IAAA2M,EAAApO,QAAAyB,QAAA0M,GAEAE,EAAA,WACA/C,EAAA,WAEA,KAAAO,EAAA,sBAAAyC,QAAAzC,EAAA,mBAAAyC,QAAAzC,EAAA,mBAAAyC,SACAzC,EAAA,oCAAA0C,WAAAnJ,OAAA,GACAyG,EAAA,oCAAA0C,WAAAC,QAAAC,SAAA,sBAIA,KAAA5C,EAAA,sBAAAyC,QAAAzC,EAAA,mBAAAyC,QAAAzC,EAAA,mBAAAyC,SACAzC,EAAA,sBAAA0C,WAAAG,OAAAC,UAAA,oCAGA9C,EAAA,+BAAA+C,YAAA,SAAA/C,EAAA,oCAAA0C,WAAAnJ,QAAA,GAIAyG,EAAA,+BAAA+C,YAAA,SAAA/C,EAAA,oCAAA0C,WAAAnJ,QAAA,MAKAqF,EAAAoE,OAAA,8BAAA,WACAR,MAIAD,EAAA1D,KAAA,SAAA,WACA2D,MAIAA,QCrCArO,QAAAC,OAAA,gBACAK,WAAA,2BAAA,SAAA,SAAA,cAAA,gBAAA,kBAAA,WAAA,YAAA,sBAAA,cAAA,uBAAA,SAAAkE,EAAApD,EAAAH,EAAAoK,EAAAyD,EAAAxD,EAAAnK,EAAAE,EAAAC,EAAAC,GAEAiD,EAAAuK,SAAA1D,EACA7G,EAAAsK,gBAAAA,EACAtK,EAAAwK,gBAAAzN,EAAAyN,gBACAxK,EAAAyK,iBACAzK,EAAA0K,OAAA3N,EAAA2N,OAEA1K,EAAAf,OAAA,WACAe,EAAAyK,iBACAzK,EAAAyK,cAAA/F,KAAA3H,EAAAa,iBACAhB,EAAAqC,UAGAe,EAAA2K,WAAA,SAAAC,EAAAC,GACA/N,EAAA6N,WAAAC,EAAAC,GACA7K,EAAAyK,iBACAzK,EAAAyK,cAAA/F,KACA5H,EAAAgO,iBACA3K,KAAA,SAAA3C,GACAT,EAAAa,oBAKAoC,EAAA+K,cAAAlO,EAAAkO,cAEA/K,EAAAgL,kBAAA,SAAAzH,EAAA0H,GACAxO,EAAAwD,IAAA,YAAAyD,IAAAH,GACAwE,YACA5H,KACA,SAAA3C,GAEAb,EAAAS,IAAA6N,EAAA,IAAAzN,EAAA2G,SAKAnE,EAAAkL,cAAA,WAEA1P,QAAA2P,QAAAnL,EAAAuK,SAAAa,kBACA,SAAAtI,EAAAuF,EAAAlG,GACAA,EAAAkG,IAAA,IAGArI,EAAAuK,SAAA5B,gBAAA,EAEA7B,EAAA,WAEA/J,EAAAsO,4BACAtO,EAAAuO,uBACA,MAGAtL,EAAAyK,cAAA/F,KAAA3H,EAAAa,oBCvDApC,QAAAC,OAAA,gBACAoF,QAAA,wBAAA,cAAA,gBAAA,kBAAA,sBAAA,SAAApE,EAAAoK,EAAAyD,EAAAzN,GACA,IAAA6N,KACAF,KAEA3J,GACA6J,OAAAA,EACAF,gBAAAA,EAEA5M,cAAA,WACA,OAAAnB,EACAwD,IAAA,cACAC,MACAC,KAAA,SAAA3C,GACAA,EAAAA,EAAA4C,QAEA5E,QAAA+L,OAAAmD,EAAAlN,GACA8M,EAAAiB,QAAA/N,EAAA+N,QACAjB,EAAAkB,aAAAhO,EAAAgO,aACAlB,EAAAmB,YAAAjO,EAAAiO,YACAjQ,QAAA+L,OAAAiD,EAAAhN,EAAAgN,sBAGA7L,IAAAkI,EAAAuE,mBACAvK,EAAAwK,iCAGA1M,IAAAkI,EAAA8B,gBACA9H,EAAAyK,sBAIAzO,EAAAgC,oBAAArB,EAAAoB,gBACA,SAAAP,OAKAgN,0BAAA,WACAxE,EAAAuE,kBAAA5P,QAAA+L,OAAAV,EAAAuE,kBAAAvK,EAAA2J,gBAAA5L,gBAGA0M,oBAAA,WACAzE,EAAA8B,eAAA9H,EAAA2J,gBAAA7B,iBAIA,OAAA9H,KC/CArF,QAAAC,OAAA,gBACAoF,QAAA,eAAA,kBAAA,cAAA,SAAAyJ,EAAA7N,GAgDA,OAzCAK,aACA4O,WAAA,SAAAd,GACA9N,YAAA6N,WAAAC,GAAA,IAGAe,kBAAA,SAAAC,GACApQ,QAAA2P,QAAAb,EAAAkB,aAAA,SAAAK,GACA,GAAAA,EAAAC,OAAAF,EAAA,OAAA9O,YAAA4O,WAAAG,EAAAE,OAIApB,WAAA,SAAAC,EAAAC,GACArP,QAAA2P,QAAAb,EAAAkB,aAAA,SAAAK,GACAA,EAAAE,IAAAnB,IACAiB,EAAAG,YAAArN,IAAAkM,GAAAgB,EAAAG,OACAnB,MAKAoB,iBAAA,WACA,IAAAC,KAMA,OALA1Q,QAAA2P,QAAAb,EAAAkB,aAAA,SAAAK,IACA,IAAAA,EAAAG,QACAE,EAAAxH,KAAAmH,EAAAE,MAGAG,GAGA/N,mBAAA,WACA3C,QAAA2P,QAAAb,EAAAkB,aAAA,SAAAK,GACAA,EAAAG,QAAA,KAIAlB,eAAA,WACA,OAAArO,EAAAiH,IAAA,aAAAY,MAAAgG,EAAAkB,gBAIA1O,eCjDAtB,QAAAC,OAAA,gBACAoF,QAAA,uBAAA,gBAAA,kBAAA,WAAA,cAAA,SAAAgG,EAAAyD,EAAAxD,EAAArK,GAEA,IAAAmC,GACAuN,WACAC,cACAC,SACAC,aACAC,YACAC,WAGA3P,GACA+B,cAAAA,EAGAiJ,iBAAA,WACA,OAAApL,EACAwD,IAAA,qBACAC,MACAC,KACA,SAAA3C,GACAA,EAAAA,EAAA4C,QACAvD,EAAAgC,oBAAArB,IAEA,WACAX,EAAA4B,SAAA,uDAKAsM,cAAA,WACA,OAAAtO,EACAwD,IAAA,iCACAC,MACAC,KACA,SAAA3C,GACAA,EAAAA,EAAA4C,QACAvD,EAAA4P,WAAA,wBACA5P,EAAAgC,oBAAArB,IACA,WACAX,EAAA4B,SAAA,sDAMAI,oBAAA,SAAArB,QACAmB,IAAAnB,IAGAoB,EAAAuN,QAAA3O,EAAA2O,QACAvN,EAAAwN,WAAA5O,EAAA4O,WAGAxN,EAAAyN,MAAAzN,EAAAyN,MAAA3D,OAAAlL,EAAA6O,OACAzN,EAAA0N,UAAA1N,EAAA0N,UAAA5D,OAAAlL,EAAA8O,WACA1N,EAAA2N,SAAA3N,EAAA2N,SAAA7D,OAAAlL,EAAA+O,UACA3N,EAAA4N,OAAA5N,EAAA4N,OAAA9D,OAAAlL,EAAAgP,QAEA3F,EAAAuE,kBAAAsB,yBACA5F,EAAA,WACAlI,EAAA0N,cACA,OAIAG,WAAA,SAAAzO,GACAY,EAAA0N,UAAA5H,MACA1G,QAAAA,EACA2O,MAAA,KAMAlO,SAAA,SAAAT,EAAAkH,EAAA0H,EAAA3O,GACAiH,OAAAvG,WAAAuG,EAAAA,EAAA,KACA0H,OAAAjO,WAAAiO,GAAAA,EACA3O,OAAAU,WAAAV,GAAAA,EAEA,IAAA4O,GAAA,EACA5D,EAAArK,EAAA4N,OACA,IAAA,IAAAM,EAAA,EAAAA,EAAA7D,EAAArI,OAAAkM,IACA7D,EAAA6D,GAAA9O,SAAAA,IACAiL,EAAA6D,GAAAH,OAAA,EACA1D,EAAA6D,GAAA5H,KAAAA,EACA+D,EAAA6D,GAAAF,WAAAA,EACA3D,EAAA6D,GAAA7O,QAAAA,EACA4O,GAAA,GAGAA,GAAAjO,EAAA4N,OAAA9H,MACA1G,QAAAA,EACAkH,KAAAA,EACAyH,MAAA,EACAC,WAAAA,EACA3O,QAAAA,KAIA8O,WAAA,SAAA/O,GACA,IAAA6O,GAAA,EACA5D,EAAArK,EAAA2N,SACA,IAAA,IAAAO,EAAA,EAAAA,EAAA7D,EAAArI,OAAAkM,IACA7D,EAAA6D,GAAA9O,SAAAA,IACAiL,EAAA6D,GAAAH,OAAA,EACAE,GAAA,GAGAA,GAAAjO,EAAA2N,SAAA7H,MACA1G,QAAAA,EACA2O,MAAA,KAIArO,QAAA,SAAAN,GACA,IAAA6O,GAAA,EACA5D,EAAArK,EAAAyN,MACA,IAAA,IAAAS,EAAA,EAAAA,EAAA7D,EAAArI,OAAAkM,IACA7D,EAAA6D,GAAA9O,SAAAA,IACAiL,EAAA6D,GAAAH,OAAA,EACAE,GAAA,GAGAA,GAAAjO,EAAAyN,MAAA3H,MACA1G,QAAAA,EACA2O,MAAA,MAKA,OAAA9P,KCpIArB,QAAAC,OAAA,gBACAK,WAAA,gCAAA,SAAA,SAAA,cAAA,gBAAA,sBAAA,SAAAkE,EAAApD,EAAAH,EAAAoK,EAAAhK,GAEAmD,EAAAgN,aAAAnG,EACA7G,EAAApB,cAAA/B,EAAA+B,cAGAoB,EAAAX,IAAA,sBAAA,WACAW,EAAApB,cAAA0N,aACAtM,EAAApB,cAAA4N,OAAAxM,EAAApB,cAAA4N,OAAAS,OAAA,SAAA5O,GACA,QAAAA,EAAAuO,aACAvO,EAAAuO,YAAA,GACA,KAIA5M,EAAApB,cAAA2N,YACAvM,EAAApB,cAAAyN,SACArM,EAAApB,cAAAwN,gBAIApM,EAAAkN,WAAA,SAAAC,EAAA9E,GACA8E,EAAAjF,OAAAG,EAAA,OCvBA7M,QAAAC,OAAA,gBACAwR,OAAA,UAAA,OAAA,SAAAG,GACA,OAAAA,EAAAC,eCFA7R,QAAAC,OAAA,gBACA8D,UAAA,oBAAA,WACA,OACAC,SAAA,IACAyG,OAAAhC,SAAA,IAAAmC,OAAA,KACArK,YAAA,gDACA2D,YAAA,KCNAlE,QAAAC,OAAA,gBACA8D,UAAA,yBAAA,WACA,OACAC,SAAA,IACAyG,OAAAhC,SAAA,IAAAmC,OAAA,KACArK,YAAA,wDCLAP,QAAAC,OAAA,gBACAqH,MAAA,kBACA9E,QAAA,aACAsP,UAAA,EAGAC,YAAA,MCmtCA/R,QAAQC,OAAO,gBAAgBe,KAAK,iBAAkB,SAASgR,GCztC/DA,EAAAC,IAAA,2CAAA,yHACAD,EAAAC,IAAA,0CAAA,kKACAD,EAAAC,IAAA,wCAAA,0IACAD,EAAAC,IAAA,yCAAA,+HACAD,EAAAC,IAAA,+BAAA,whDACAD,EAAAC,IAAA,iCAAA,ihJACAD,EAAAC,IAAA,kCAAA,kIACAD,EAAAC,IAAA,oCAAA,0yNACAD,EAAAC,IAAA,gDAAA,qwMACAD,EAAAC,IAAA,0BAAA,+cACAD,EAAAC,IAAA,2BAAA,maACAD,EAAAC,IAAA,gDAAA,krBACAD,EAAAC,IAAA,qDAAA,kqBACAD,EAAAC,IAAA,sCAAA","file":"ampersand.min.js","sourcesContent":["// when using minified angular modules, use module('myApp', []).controller('MyController', ['myService', function (myService) { ...\r\nangular.module('AmpersandApp', ['ngResource', 'ngRoute', 'ngSanitize', 'restangular', 'ui.bootstrap', 'uiSwitch', 'cgBusy', 'siTable', 'ui.codemirror', 'ngStorage', 'angularFileUpload', 'ui.bootstrap.datetimepicker', 'hc.marked'])\r\n.config(function($routeProvider, $locationProvider) {\r\n    $routeProvider\r\n        // default start page\r\n        .when('/', { \r\n            controller : '',\r\n            templateUrl : 'app/src/shared/home.html',\r\n            interfaceLabel : 'Home'\r\n            })\r\n        // installer page\r\n        .when('/admin/installer', {\r\n            controller : 'InstallerController',\r\n            templateUrl : 'app/src/admin/installer.html',\r\n            interfaceLabel : 'Installer'\r\n            })\r\n        .when('/404', {\r\n            templateUrl: 'app/src/shared/404.html',\r\n            interfaceLabel: '404'\r\n            })\r\n        .otherwise({redirectTo: '/404'});\r\n    \r\n    $locationProvider.hashPrefix(''); // see: https://stackoverflow.com/questions/41211875/angularjs-1-6-0-latest-now-routes-not-working\r\n}).config(function(RestangularProvider) {\r\n    \r\n    RestangularProvider.setBaseUrl('api/v1'); // Generate: path to API folder\r\n    RestangularProvider.setDefaultHeaders({\"Content-Type\": \"application/json\"});\r\n    // RestangularProvider.setPlainByDefault(true); available from Restangular v1.5.3\r\n    \r\n}).run(function(Restangular, $rootScope, $location, $route, NotificationService, RoleService, NavigationBarService){\r\n\r\n    Restangular.addFullRequestInterceptor(function(element, operation, what, url, headers, params){\r\n        //params.navIfc = true;\r\n        //params.metaData = true;\r\n        return params;\r\n    });\r\n    \r\n    Restangular.addResponseInterceptor(function(data, operation, what, url, response, deferred){\r\n        if(operation != 'get' && operation != 'getList' && data.sessionRefreshAdvice) NavigationBarService.refreshNavBar();\r\n\t\tif((data || {}).navTo != null) $location.url(data.navTo);\r\n        \r\n        return data;\r\n    });\r\n    \r\n    Restangular.setErrorInterceptor(function(response, deferred, responseHandler) {\r\n        // 401: Unauthorized\r\n        if(response.status == 401) {\r\n            RoleService.deactivateAllRoles();\r\n            $location.path(''); // TODO: redirect to login page (if exists)\r\n        }\r\n        \r\n        var message;\r\n        var details;\r\n        if(typeof response.data === 'object'){\r\n            if(response.data.error == 404) {\r\n                NotificationService.addInfo(response.data.msg || 'Resource not found');\r\n            } else {\r\n                message = response.data.msg || response.statusText; // if empty response message, take statusText\r\n                NotificationService.addError(message, response.status, true, response.data.html);\r\n            }\r\n            \r\n            if(response.data.notifications !== undefined) NotificationService.updateNotifications(response.data.notifications); \r\n        }else{\r\n            message = response.status + ' ' + response.statusText;\r\n            details = response.data; // html content is excepted\r\n            NotificationService.addError(message, response.status, true, details);\r\n        }\r\n        \r\n        return true; // proceed with success or error hooks of promise\r\n    });\r\n    \r\n    $rootScope.getCurrentDateTime = function (){\r\n        return new Date();\r\n    };\r\n    \r\n    // Add feature to $location.url() function to be able to prevent reloading page (set reload param to false)\r\n    var original = $location.url;\r\n    $location.url = function (url, reload) {\r\n        if (reload === false) {\r\n            var lastRoute = $route.current;\r\n            var un = $rootScope.$on('$locationChangeSuccess', function () {\r\n                $route.current = lastRoute;\r\n                un();\r\n            });\r\n        }\r\n        return original.apply($location, [url]);\r\n    };\r\n});\r\n","angular.module('uiSwitch', [])\r\n\r\n.directive('switch', function(){\r\n  return {\r\n    restrict: 'AE'\r\n  , replace: true\r\n  , transclude: true\r\n  , template: function(element, attrs) {\r\n      var html = '';\r\n      html += '<a href=\"\"';\r\n      html +=   (attrs.ngModel && !attrs.ngClick) ? ' ng-click=\"' + attrs.ngModel + '=!' + attrs.ngModel + '\"' : '';\r\n      html += '>';\r\n      html += '<span';\r\n      html +=   ' class=\"switch' + (attrs.class ? ' ' + attrs.class : '') + '\"';\r\n      html +=   ' ng-class=\"{ checked:' + attrs.ngModel + ' }\"';\r\n      html +=   '>';\r\n      html +=   '<small></small>';\r\n      html += '</span>';\r\n      html += '<span ng-transclude></span>';\r\n      html += '</a>';\r\n      return html;\r\n    }\r\n  }\r\n});","// Controller for extension app in navigation bar\r\nangular.module('AmpersandApp')\r\n.controller('ExecEngineController', function ($scope, Restangular, NotificationService) {\r\n    $scope.run = function (){\r\n        Restangular.one('admin/execengine/run').get()\r\n        .then(\r\n            function(data){ // on success\r\n                data = data.plain();\r\n                NotificationService.updateNotifications(data);\r\n            }\r\n        );\r\n    };\r\n});\r\n","angular.module('AmpersandApp')\r\n.controller('InstallerController', function ($scope, Restangular, NotificationService, RoleService) {\r\n    $scope.installing = false;\r\n    $scope.installed = false;\r\n    \r\n    $scope.install = function(defPop){\r\n        $scope.installing = true;\r\n        $scope.installed = false;\r\n        Restangular.one('admin/installer').get({defaultPop : defPop}).then(function(data) {\r\n            data = data.plain();\r\n            NotificationService.updateNotifications(data);\r\n            \r\n            // deactive all roles\r\n            RoleService.deactivateAllRoles();\r\n            \r\n            $scope.installing = false;\r\n            $scope.installed = true;\r\n        }, function(){\r\n            $scope.installing = false;\r\n            $scope.installed = false;\r\n        });\r\n    };\r\n});\r\n","var app = angular.module('AmpersandApp');\r\napp.requires[app.requires.length] = 'angularFileUpload'; // add angularFileUpload to dependency list\r\napp.config(function($routeProvider) {\r\n    $routeProvider\r\n        .when('/ext/importer', {\r\n            controller : 'PopulationImportController',\r\n            templateUrl : 'app/src/importer/importer.html',\r\n            interfaceLabel : 'Population importer'\r\n        });\r\n}).service('ImportService', function(FileUploader, NotificationService){\r\n    let uploader = new FileUploader({\r\n        url: 'api/v1/admin/import'\r\n    });\r\n\r\n    uploader.onSuccessItem = function(fileItem, response, status, headers) {\r\n        NotificationService.updateNotifications(response.notifications);\r\n    };\r\n    \r\n    uploader.onErrorItem = function(item, response, status, headers){\r\n        let message;\r\n        let details;\r\n        if(typeof response === 'object'){\r\n            message = response.msg || 'Error while importing';\r\n            NotificationService.addError(message, status, true);\r\n            \r\n            if(response.notifications !== undefined) NotificationService.updateNotifications(response.notifications); \r\n        }else{\r\n            message = status + ' Error while importing';\r\n            details = response; // html content is excepted\r\n            NotificationService.addError(message, status, true, details);\r\n        }\r\n    };\r\n    \r\n    return {uploader : uploader};\r\n}).controller('PopulationImportController', function ($scope, ImportService) {\r\n    $scope.uploader = ImportService.uploader;\r\n});\r\n","angular.module('AmpersandApp')\r\n.controller('AtomicController', function($scope, ResourceService){\r\n    \r\n    /*\r\n     * Object to temporary store value/resourceId to add to list\r\n     * Value/resourceId is stored as property of 'selected' obj. This is needed to pass it around by reference\r\n     */\r\n    $scope.selected = {};\r\n    \r\n    $scope.saveItem = ResourceService.saveItem; // function(resource, ifc, patchResource)\r\n    \r\n    $scope.addItem = ResourceService.addItem; // function(resource, ifc, selected, patchResource)\r\n    \r\n    $scope.removeItem = ResourceService.removeItem; // function(resource, ifc, index, patchResource)\r\n    \r\n    $scope.remove = ResourceService.removeResource; // function(ifc, resource, patchResource)\r\n    \r\n    $scope.delete = ResourceService.deleteResource; // function(ifc, resource)\r\n});\r\n","angular.module('AmpersandApp')\r\n.controller('AtomicDateController', function ($scope, ResourceService) {\r\n    \r\n    $scope.isOpen = false;\r\n    \r\n    $scope.openDatepicker = function($event){\r\n        $event.preventDefault();\r\n        $event.stopPropagation();\r\n        $scope.isOpen = true;\r\n    };\r\n    \r\n    // Adds leading 0 if necesarry. Returns 2 digits.\r\n    function pad(number) {\r\n        var r = String(number);\r\n        if ( r.length === 1 ) {\r\n            r = '0' + r;\r\n        }\r\n        return r;\r\n    }\r\n    \r\n    function modifyToJSON(obj){\r\n        if(obj !== null){\r\n            obj.toJSON = function(){\r\n                return this.getUTCFullYear() + \r\n                    '-' + pad(this.getMonth() + 1) + // The getMonth() method returns the month in the specified date according to local time, as a zero-based value (where zero indicates the first month of the year).\r\n                    '-' + pad(this.getDate());\r\n            };\r\n        }\r\n    }\r\n    \r\n    $scope.selected = { value : ''}; // an empty object for temporary storing the input values\r\n    \r\n    $scope.saveDateItem = function(obj, property, patchResource){\r\n        modifyToJSON(obj[property]);\r\n        ResourceService.saveItem(obj, property, patchResource);\r\n    };\r\n    \r\n    $scope.addDateItem = function(obj, property, selected, patchResource){\r\n        if(selected.value !== ''){\r\n            modifyToJSON(selected.value);\r\n            ResourceService.addItem(obj, property, selected, patchResource);\r\n        }else{\r\n            console.log('Empty date selected');\r\n        }\r\n    };\r\n});\r\n","angular.module('AmpersandApp')\r\n.controller('AtomicTypeAheadController', function($scope, Restangular, ResourceService){\r\n    \r\n    /*\r\n     * Object to temporary store value/resourceId to add to list\r\n     * Value/resourceId is stored as property of 'selected' obj. This is needed to pass it around by reference\r\n     */\r\n    $scope.selected = {};\r\n    \r\n    $scope.hasNoResults = false;\r\n    \r\n    /*\r\n     * Typeahead object is declared in interface.controller.js\r\n     * Thereby typeahead is called only once for every resourceType per interface\r\n     */\r\n    // $scope.typeahead = {};\r\n    \r\n    /*\r\n     * Typeahead functionality\r\n     * $scope.typeahead is initiated in InterfaceController to be able to reuse typeahead data\r\n     */\r\n    $scope.getTypeahead = function(resourceType, forceGetCall){\r\n        forceGetCall = typeof forceGetCall !== 'undefined' ? forceGetCall : false;\r\n\r\n        // Only if not yet set\r\n        if(typeof $scope.typeahead[resourceType] === 'undefined' || forceGetCall){\r\n            $scope.typeahead[resourceType] = Restangular.all('resource/' + resourceType).getList().$object;\r\n        }\r\n    };\r\n    \r\n    $scope.typeaheadOnSelect = function ($item, $model, $label, resource, ifc, patchResource){\r\n        if(typeof $item._id_ === 'undefined') console.log('Resource id undefined');\r\n        else if($item._id_ === '') console.log('Empty resource id provided');\r\n        else{\r\n            if(Array.isArray(resource[ifc])){\r\n                // Construct patch(es)\r\n                patch = ResourceService.createPatch('add', resource, patchResource, ifc, $item._id_);\r\n                ResourceService.addPatches(patchResource, [patch])\r\n                .then(function(data){\r\n                    // Adapt in js model\r\n                    if(!data.saved) resource[ifc].push(angular.copy($item));\r\n                });\r\n                \r\n            }else if(resource[ifc] === null){\r\n                // Construct patch(es)\r\n                patch = ResourceService.createPatch('replace', resource, patchResource, ifc, $item._id_);\r\n                ResourceService.addPatches(patchResource, [patch])\r\n                .then(function(data){\r\n                    // Adapt js model\r\n                    if(!data.saved) resource[ifc] = angular.copy($item);\r\n                });\r\n            }\r\n            else console.log('Error: Property already set and/or not defined');\r\n            \r\n            $scope.hasNoResults = false;\r\n        }\r\n        // Empty selected input\r\n        $scope.selected.value = '';\r\n    };\r\n    \r\n    $scope.typeAheadCreate = function (resource, ifc, selected, patchResource, resourceType){\r\n        if(Array.isArray(resource[ifc])) { \r\n            ResourceService.addItem(resource, ifc, selected, patchResource).then(\r\n                function(){\r\n                    $scope.getTypeahead(resourceType, true);\r\n                }\r\n            );\r\n        } else if(resource[ifc] === null) {\r\n            resource[ifc] = selected.value;\r\n            ResourceService.saveItem(resource, ifc, patchResource);\r\n        } else {\r\n            console.log('Error: Property already set and/or not defined');\r\n        }\r\n    };\r\n});\r\n","angular.module('AmpersandApp')\r\n.controller('AtomicUploadFileController', function($scope, FileUploader, NotificationService){\r\n    \r\n    // File uploader stuff\r\n    $scope.FileUploader = new FileUploader({\r\n        alias : 'file', // fieldname as used in $_FILES['file']\r\n        formData : [],\r\n        removeAfterUpload : true,\r\n        autoUpload : true\r\n    });\r\n    \r\n    $scope.FileUploader.onSuccessItem = function(fileItem, response, status, headers){\r\n        NotificationService.updateNotifications(response.notifications);\r\n        \r\n        // Add response content (newly created FileObject) to ifc list in resource\r\n        fileItem.resource[fileItem.ifc].push(response.content);\r\n    };\r\n    \r\n    $scope.FileUploader.onErrorItem = function(item, response, status, headers){\r\n        NotificationService.addError(response.error.message, response.error.code, true);\r\n    };\r\n});\r\n","angular.module('AmpersandApp')\r\n.controller('BoxController', function($scope, ResourceService){\r\n    \r\n    // Function to create a new resource (does a POST)\r\n    $scope.createResource = ResourceService.createResource; // function(resource, ifc, callingObj, prepend)\r\n    \r\n    // Function to save certain attributes changes of a resource (does a PATCH)\r\n    $scope.save = ResourceService.saveResource; // function(resource)\r\n    \r\n    // Function to cancel unsaved edits (does a GET)\r\n    $scope.cancel = ResourceService.cancelResource; // function(resource)\r\n    \r\n    // Function to remove a resource from an interface (list)\r\n    $scope.remove = ResourceService.removeResource; // function(ifc, resource, patchResource)\r\n    \r\n    // Function to delete a resource\r\n    $scope.delete = ResourceService.deleteResource; // function(ifc, resource)\r\n});\r\n","angular.module('AmpersandApp')\r\n.controller('InterfaceController', function($scope, $location, ResourceService){\r\n    /*\r\n     * An empty object for typeahead functionality.\r\n     * Defined here so it can be reused in an interface\r\n     * Prevents multiple calls for the same resourceType\r\n     */\r\n    $scope.typeahead = {};\r\n    \r\n    // Detects location changes and checks if there are unsaved changes\r\n    $scope.$on(\"$locationChangeStart\", function(event, next, current){\r\n        if(ResourceService.checkRequired()){\r\n            confirmed = confirm(\"You have unsaved edits. Do you wish to leave?\");\r\n            if (event && !confirmed) event.preventDefault();\r\n            else if(event && confirmed) ResourceService.emptyUpdatedResources();\r\n            else console.log('Someting went wrong. Cannot determine action after locationChangeStart');\r\n        }\r\n    });\r\n    \r\n    // Function to change location to create a new resource\r\n    $scope.newResource = function(){\r\n        $location.url('/' + ifcName + '?new');\r\n    };\r\n    \r\n    // Function (reference) to check if there are pending promises for a resource\r\n    $scope.pendingPromises = ResourceService.pendingPromises;\r\n});\r\n","angular.module('AmpersandApp')\r\n.directive('myBluronenter', function() {\r\n    return function(scope, element, attrs) {\r\n        element.bind(\"keydown keypress\", function(event) {\r\n            if(event.which === 13) { // 13 = Carriage return\r\n                event.target.blur();\r\n\r\n                event.preventDefault();\r\n            }\r\n        });\r\n    };\r\n});\r\n","angular.module('AmpersandApp')\r\n.directive('myShowonhoverBox', function (){\r\n    return {\r\n        link : function(scope, element, attrs) {\r\n            if(!element.closest('.box').hasClass('my-showonhover-box-show')) element.hide(); // default hide\r\n            \r\n            element.closest('.box').bind('mouseenter', function() {\r\n                element.closest('.box').addClass('my-showonhover-box-show');\r\n                element.show();\r\n            });\r\n            element.closest('.box').bind('mouseleave', function() {\r\n                element.closest('.box').removeClass('my-showonhover-box-show');\r\n                element.hide();\r\n            });\r\n        }\r\n    };\r\n});\r\n","angular.module('AmpersandApp')\r\n.service('ResourceService', function($localStorage, $timeout, $location, Restangular, NotificationService, $q){\r\n    // http://blog.thoughtram.io/angular/2015/07/07/service-vs-factory-once-and-for-all.html\r\n    \r\n    let updatedResources = []; // contains list with updated resource objects in this interface. Used to check if there are uncommmitted changes (patches in cache)\r\n    \r\n    let ResourceService = {\r\n        /**\r\n         * Get resource data given a certain interface (ifc)\r\n         * \r\n         * @param {Object} resource\r\n         * @param {string} ifc\r\n         * @param {Object} callingObj will be used for loading indicator\r\n         * @returns {Promise}\r\n         */\r\n        getResource : function(resource, ifc, callingObj){\r\n            promise = Restangular\r\n            .one(resource._path_ + '/' + ifc)\r\n            .get()\r\n            .then(function(data){\r\n                try {\r\n                    data = data.plain();\r\n                }catch(error){}\r\n                if($.isEmptyObject(data)) NotificationService.addInfo('No results found');\r\n                else if(resource[ifc] === null || Array.isArray(resource[ifc])) resource[ifc] = data;\r\n                else angular.extend(resource[ifc], data);\r\n                \r\n                ResourceService.initResourceMetaData(resource);\r\n\r\n                return resource;\r\n            });\r\n            \r\n            // Add promise to loading list\r\n            if(!Array.isArray(callingObj._loading_)) callingObj._loading_ = [];\r\n            callingObj._loading_.push(promise);\r\n            \r\n            return promise;\r\n        },\r\n\r\n        /**\r\n         * Patch the given resource by calling the API and sending the list of stored patches \r\n         * \r\n         * @param {Object} resource\r\n         * @returns {Promise}\r\n         */\r\n        saveResource : function(resource){\r\n            promise = Restangular\r\n            .one(resource._path_)\r\n            .patch(resource._patchesCache_, {})\r\n            .then(function(data) {\r\n                data = data.plain();\r\n                \r\n                // Update resource data\r\n                if(resource._isRoot_) resource.get();\r\n                else resource = angular.extend(resource, data.content);\r\n                \r\n                // Update visual feedback (notifications and buttons)\r\n                ResourceService.processResponse(resource, data);\r\n\r\n                return {resource : resource, saved: true};\r\n            });\r\n\r\n            // Add promise to loading list\r\n            if(!Array.isArray(resource._loading_)) resource._loading_ = [];\r\n            resource._loading_.push(promise);\r\n            \r\n            return promise;\r\n        },\r\n        \r\n        /**\r\n         * Cancel unsaved edits and get resource data\r\n         * \r\n         * @param {Object} resource\r\n         * @returns {Promise}\r\n         */\r\n        cancelResource : function(resource){\r\n            promise = Restangular\r\n            .one(resource._path_)\r\n            .get()\r\n            .then(function(data){\r\n                data = data.plain();\r\n                if($.isEmptyObject(data)) NotificationService.addInfo('No results found');\r\n                else angular.extend(resource, data);\r\n                \r\n                // Update visual feedback (notifications and buttons)\r\n                NotificationService.getNotifications();\r\n                ResourceService.initResourceMetaData(resource);\r\n\r\n                return resource;\r\n            });\r\n            \r\n            // Add promise to loading list\r\n            if(!Array.isArray(resource._loading_)) resource._loading_ = [];\r\n            resource._loading_.push(promise);\r\n            \r\n            return promise;\r\n        },\r\n        \r\n        /**\r\n         * Create (POST) a new resource to a certain interface list\r\n         * \r\n         * @param {Object} resource\r\n         * @param {string} ifc\r\n         * @param {Object} callingObj will be used for loading indicator\r\n         * @param {bool} prepend\r\n         * @returns {Promise}\r\n         */\r\n        createResource : function(resource, ifc, callingObj, prepend){\r\n            if(prepend === 'undefined') prepend = false;\r\n            \r\n            promise = Restangular\r\n            .one(resource._path_).all(ifc)\r\n            .post({}, {})\r\n            .then(function(data){\r\n                data = data.plain();\r\n                // Update visual feedback (notifications and buttons)\r\n                ResourceService.processResponse(callingObj, data);\r\n\r\n                newResource = data.content;\r\n                \r\n                // Add new resource to ifc\r\n                if(Array.isArray(resource[ifc])){ // non-uni = list\r\n                    if(prepend) resource[ifc].unshift(newResource);\r\n                    else resource[ifc].push(newResource);\r\n                }else{ // uni = object\r\n                    resource[ifc] = newResource;\r\n                }\r\n                \r\n                if(resource._isRoot_ && resource._id_ == '_NEW') $location.url('/' + ifc + '/'+ newResource._id_, false);\r\n\r\n                return newResource;\r\n            });\r\n\r\n            // Add promise to loading list\r\n            if(!Array.isArray(callingObj._loading_)) callingObj._loading_ = [];\r\n            callingObj._loading_.push(promise);\r\n            \r\n            return promise;\r\n        },\r\n        \r\n        /**\r\n         * Remove a resource from a certain interface list\r\n         * \r\n         * @param {Object} parent\r\n         * @param {string} ifc\r\n         * @param {Object} resource\r\n         * @param {bool} patchResource\r\n         * @returns {Promise}\r\n         */\r\n        removeResource : function(parent, ifc, resource, patchResource){\r\n            // Construct patch(es)\r\n            patch = ResourceService.createPatch('remove', resource, patchResource);\r\n\r\n            // Execute patch\r\n            return ResourceService\r\n            .addPatches(patchResource, [patch])\r\n            .then(function(data){\r\n                // Adapt js model\r\n                if(Array.isArray(parent[ifc])) parent[ifc].splice(parent[ifc].indexOf(resource), 1); // non-uni = list\r\n                else parent[ifc] = null; // uni = object\r\n            });\r\n        },\r\n        \r\n        /**\r\n         * Delete a resource\r\n         * \r\n         * @param {Object} parent\r\n         * @param {string} ifc\r\n         * @param {Object} resource to delete\r\n         * @returns {Promise}\r\n         */\r\n        deleteResource : function(parent, ifc, resource){\r\n            if(confirm('Are you sure?')){\r\n                promise = Restangular\r\n                .one(resource._path_)\r\n                .remove({})\r\n                .then(function(data){\r\n                    data = data.plain();\r\n                    // Update visual feedback (notifications and buttons)\r\n                    NotificationService.updateNotifications(data.notifications);\r\n                    \r\n                    // Remove resource from ifc\r\n                    if(Array.isArray(parent[ifc])) parent[ifc].splice(parent[ifc].indexOf(resource), 1); // non-uni = list\r\n                    else parent[ifc] = null; // uni = object\r\n\r\n                    return parent;\r\n                });\r\n\r\n                // Add promise to loading list\r\n                if(!Array.isArray(resource._loading_)) resource._loading_ = [];\r\n                resource._loading_.push(promise);\r\n                \r\n                return promise;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Save/patch a changed attribute\r\n         * \r\n         * @param {Object} resource\r\n         * @param {string} ifc\r\n         * @param {Object} patchResource\r\n         * @returns {Promise}\r\n         */\r\n        saveItem : function(resource, ifc, patchResource){\r\n            // Construct patch(es)\r\n            if(typeof resource[ifc] === 'undefined' || resource[ifc] === '') {\r\n                value = null;\r\n            } else {\r\n                value = resource[ifc];\r\n            }\r\n            patch = ResourceService.createPatch('replace', resource, patchResource, ifc, value);\r\n\r\n            // Register patch\r\n            return ResourceService.addPatches(patchResource, [patch]);\r\n        },\r\n        \r\n        /**\r\n         * Add an item to an interface list\r\n         * \r\n         * @param {Object} resource\r\n         * @param {string} ifc\r\n         * @param {Object} selected item to add to the list\r\n         * @param {Object} patchResource\r\n         * @returns {Promise}\r\n         */\r\n        addItem : function(resource, ifc, selected, patchResource){\r\n            if(typeof selected.value === 'undefined') {\r\n                //console.log('Value undefined');\r\n                return $q.reject('Value undefined');\r\n            } else if(selected.value === '') {\r\n                //console.log('Empty value selected');\r\n                return $q.reject('Empty value selected');\r\n            } else if(!Array.isArray(resource[ifc])) {\r\n                //console.log('Error: trying to add item to non-array');\r\n                return $q.reject('Error: trying to add item to non-array');\r\n            } else{\r\n                // Adapt in js model\r\n                resource[ifc].push(selected.value);\r\n                \r\n                // Construct patch(es)\r\n                patch = ResourceService.createPatch('add', resource, patchResource, ifc, selected.value);\r\n                return ResourceService.addPatches(patchResource, [patch]).then(function(data){\r\n                    // Reset selected value\r\n                    delete(selected.value);\r\n                    return data;\r\n                });\r\n            }\r\n        },\r\n        \r\n        /**\r\n         * Remove an item from an interface list\r\n         * \r\n         * @param {Object} resource\r\n         * @param {string} ifc\r\n         * @param {int} index\r\n         * @param {Object} patchResource\r\n         * @returns {Promise}\r\n         */\r\n        removeItem : function(resource, ifc, index, patchResource){\r\n            // Construct patch(es)\r\n            value = resource[ifc][index];\r\n            patch = ResourceService.createPatch('remove', resource, patchResource, ifc, value);\r\n            \r\n            // Adapt js model\r\n            resource[ifc].splice(index, 1);\r\n\r\n            return ResourceService.addPatches(patchResource, [patch]);\r\n        },\r\n        \r\n        /**\r\n         * Construct patch object (with attributes 'op', 'path' and 'value')\r\n         * \r\n         * @param {string} operation choose from 'add', 'remove' or 'replace'\r\n         * @param {Object} resource\r\n         * @param {Object} patchResource\r\n         * @param {string} ifc\r\n         * @param {string} value\r\n         * @returns {Object}\r\n         */\r\n        createPatch : function(operation, resource, patchResource, ifc, value){\r\n            if(typeof patchResource === 'undefined') patchResource = resource;\r\n            pathLength = patchResource._path_.length;\r\n            \r\n            path = resource._path_.substring(pathLength);\r\n            if(typeof ifc !== 'undefined') path = path + '/' + ifc;\r\n            \r\n            if(typeof value === 'undefined') return { op : operation, path : path};\r\n            else return { op : operation, path : path, value : value};\r\n        },\r\n        \r\n        /**\r\n         * Add list of patches for given resource and call API (when auto-save is on)\r\n         * \r\n         * @param {Object} resource\r\n         * @param {Object[]} patches\r\n         * @returns {Promise}\r\n         */\r\n        addPatches : function(resource, patches){\r\n            // Add new patches to resource\r\n            if(!Array.isArray(resource._patchesCache_)) resource._patchesCache_ = [];\r\n            resource._patchesCache_ = resource._patchesCache_.concat(patches);\r\n            \r\n            // Add resource to updatedResources\r\n            if(updatedResources.indexOf(resource) === -1) updatedResources.push(resource);\r\n            \r\n            // Save if autoSave is enabled\r\n            if($localStorage.switchAutoSave) {\r\n                return ResourceService.saveResource(resource);\r\n            } else {\r\n                // Update visual feedback\r\n                ResourceService.setResourceStatus(resource, 'warning');\r\n                resource._showButtons_ = {'save' : true, 'cancel' : true};\r\n                return $q.resolve({resource : resource, saved : false});\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Returns if there are unsaved changes (i.e. patches that are not yet sent to the API)\r\n         * \r\n         * @returns {bool}\r\n         */\r\n        checkRequired : function(){ \r\n            updatedResources.reduce(function(prev, item, index, arr){\r\n                return prev || item._patchesCache_.length;\r\n            }, false);\r\n        },\r\n        \r\n        /**\r\n         * Clear list of updated resources\r\n         */\r\n        emptyUpdatedResources : function(){\r\n            updatedResources = [];\r\n        },\r\n        \r\n        /**\r\n         * Init/reset resource meta data\r\n         * \r\n         * @param {Object} resource\r\n         */\r\n        initResourceMetaData : function(resource){\r\n            resource._showButtons_ = {'save' : false, 'cancel' : false};\r\n            resource._patchesCache_ = [];\r\n            ResourceService.setResourceStatus(resource, 'default');\r\n        },\r\n        \r\n        /**\r\n         * Process response: i.e. set resource buttons and status\r\n         * \r\n         * @param {Object} resource\r\n         * @param {Object} response from API\r\n         * @returns {Object}\r\n         */\r\n        processResponse : function(resource, response){\r\n            NotificationService.updateNotifications(response.notifications);\r\n            \r\n            if(response.invariantRulesHold){\r\n                resource._showButtons_ = {'save' : false, 'cancel' : false};\r\n                resource._patchesCache_ = []; // empty patches cache\r\n                ResourceService.setResourceStatus(resource, 'success');\r\n                \r\n                // After 3 seconds, reset status to default\r\n                $timeout(function(){\r\n                    ResourceService.setResourceStatus(resource, 'default');\r\n                }, 3000);\r\n            }else{\r\n                resource._showButtons_ = {'save' : false, 'cancel' : true};\r\n                ResourceService.setResourceStatus(resource, 'danger');\r\n            }\r\n\r\n            return resource;\r\n        },\r\n        \r\n        /**\r\n         * Set resource status meta data\r\n         * \r\n         * @param {Object} resource\r\n         * @param {string} status choose from 'warning', 'danger', 'success' or 'default'\r\n         * @returns {Object}\r\n         */\r\n        setResourceStatus : function(resource, status){\r\n            // Reset all status properties\r\n            resource._status_ = { 'warning' : false,\r\n                                  'danger'  : false,\r\n                                  'default' : false,\r\n                                  'success' : false\r\n                                };\r\n            // Set status property\r\n            resource._status_[status] = true;\r\n            \r\n            return resource;\r\n        },\r\n        \r\n        /**\r\n         * Returns if resource has pending promises\r\n         * \r\n         * @param {Object} resource\r\n         * @returns {bool}\r\n         */\r\n        pendingPromises : function(resource){\r\n            if(!Array.isArray(resource._loading_)) return false; // empty array contains no pending promises\r\n            \r\n            return resource._loading_.some(function(val){\r\n                return val.$$state.status === 0; // promise status: 0 -> pending, 1 -> resolved, 2 -> rejected\r\n            });\r\n        }\r\n    };\r\n    \r\n    return ResourceService;\r\n});\r\n","angular.module('AmpersandApp')\r\n.directive('myNavbarResize', function ($window, $timeout, NavigationBarService) {\r\n    return function (scope, element) {\r\n        var w = angular.element($window);\r\n        \r\n        var resizeNavbar = function() {\r\n            $timeout(function(){\r\n                // moving ifc items from dropdown-menu to navbar itself\r\n                while($('#navbar-interfaces').width() < ($('#navbar-wrapper').width() - $('#navbar-options').width()) &&\r\n                        $('#navbar-interfaces-dropdown-menu').children().length > 0){\r\n                    $(\"#navbar-interfaces-dropdown-menu\").children().first().appendTo(\"#navbar-interfaces\");\r\n                }\r\n                \r\n                // moving ifc items from navbar to dropdown-menu\r\n                while($('#navbar-interfaces').width() > ($('#navbar-wrapper').width() - $('#navbar-options').width())){\r\n                    $(\"#navbar-interfaces\").children().last().prependTo(\"#navbar-interfaces-dropdown-menu\");\r\n                    \r\n                    // show/hide dropdown menu for more interfaces (must be inside loop, because it affects the width of the navbar\r\n                    $('#navbar-interfaces-dropdown').toggleClass('hidden', $('#navbar-interfaces-dropdown-menu').children().length <= 0);\r\n                }\r\n                \r\n                // show/hide dropdown menu when possible\r\n                $('#navbar-interfaces-dropdown').toggleClass('hidden', $('#navbar-interfaces-dropdown-menu').children().length <= 0);\r\n            });\r\n        };\r\n        \r\n        // watch navbar\r\n        scope.$watch('NavigationBarService.navbar', function() {\r\n            resizeNavbar();\r\n        });\r\n        \r\n        // when window size gets changed\r\n        w.bind('resize', function () {        \r\n            resizeNavbar();\r\n        });\r\n        \r\n        // when page loads\r\n        resizeNavbar();\r\n    };\r\n});\r\n","angular.module('AmpersandApp')\r\n.controller('NavigationBarController', function ($scope, $route, Restangular, $localStorage, $sessionStorage, $timeout, $location, NotificationService, RoleService, NavigationBarService) {\r\n    \r\n    $scope.$storage = $localStorage;\r\n    $scope.$sessionStorage = $sessionStorage;\r\n    $scope.defaultSettings = NavigationBarService.defaultSettings;\r\n    $scope.loadingNavBar = [];\r\n    $scope.navbar = NavigationBarService.navbar;\r\n    \r\n    $scope.reload = function(){\r\n        $scope.loadingNavBar = [];\r\n        $scope.loadingNavBar.push(NavigationBarService.refreshNavBar());\r\n        $route.reload();\r\n    };\r\n\r\n    $scope.toggleRole = function(roleId, set){\r\n        RoleService.toggleRole(roleId, set);\r\n        $scope.loadingNavBar = [];\r\n        $scope.loadingNavBar.push(\r\n            RoleService.setActiveRoles()\r\n            .then(function(data){\r\n                NavigationBarService.refreshNavBar();\r\n            })\r\n        );\r\n    };\r\n\r\n    $scope.checkAllRules = NotificationService.checkAllRules;\r\n\r\n    $scope.createNewResource = function(resourceType, openWithIfc){\r\n        Restangular.one('resource').all(resourceType)\r\n        .post({}, {})\r\n        .then(\r\n            function(data){\r\n                // Jumps to interface and requests newly created resource\r\n                $location.url(openWithIfc + '/' + data._id_);\r\n            }\r\n        );\r\n    };\r\n    \r\n    $scope.resetSettings = function(){\r\n        // all off\r\n        angular.forEach($scope.$storage.notificationPrefs, \r\n            function(value, index, obj){\r\n                obj[index] = false;\r\n            }\r\n        );\r\n        $scope.$storage.switchAutoSave = false;\r\n        \r\n        $timeout(function() {\r\n            // reset to default        \r\n            NavigationBarService.resetNotificationSettings();\r\n            NavigationBarService.resetSwitchAutoSave();\r\n        }, 500);\r\n    };\r\n    \r\n    $scope.loadingNavBar.push(NavigationBarService.refreshNavBar());\r\n});\r\n","angular.module('AmpersandApp')\r\n.service('NavigationBarService', function(Restangular, $localStorage, $sessionStorage, NotificationService){\r\n    let navbar = {};\r\n    let defaultSettings = {};\r\n\r\n    let service = {\r\n        navbar : navbar,\r\n        defaultSettings : defaultSettings,\r\n\r\n        refreshNavBar : function(){\r\n            return Restangular\r\n            .one('app/navbar')\r\n            .get()\r\n            .then(function(data){\r\n                data = data.plain();\r\n\r\n                angular.extend(navbar, data);\r\n                $sessionStorage.session = data.session;\r\n                $sessionStorage.sessionRoles = data.sessionRoles;\r\n                $sessionStorage.sessionVars = data.sessionVars;\r\n                angular.extend(defaultSettings, data.defaultSettings);\r\n                \r\n                // Default settings for notificationPrefs\r\n                if($localStorage.notificationPrefs === undefined){\r\n                    service.resetNotificationSettings();\r\n                }\r\n                // Default setting for switchAutoSave\r\n                if($localStorage.switchAutoSave === undefined){\r\n                    service.resetSwitchAutoSave();\r\n                }\r\n                \r\n                // Update notifications\r\n                NotificationService.updateNotifications(data.notifications);\r\n            }, function(error){\r\n                // on error\r\n            });\r\n        },\r\n\r\n        resetNotificationSettings : function(){\r\n            $localStorage.notificationPrefs = angular.extend($localStorage.notificationPrefs, service.defaultSettings.notifications);\r\n        },\r\n\r\n        resetSwitchAutoSave : function(){\r\n            $localStorage.switchAutoSave = service.defaultSettings.switchAutoSave;\r\n        }\r\n    };\r\n    \r\n    return service;\r\n});\r\n","angular.module('AmpersandApp')\r\n.service('RoleService', function($sessionStorage, Restangular){\r\n    \r\n    /*\r\n     * Available roles are registered in $sessionStorage.sessionRoles\r\n     * A role has the following attributes: id, label, active\r\n     */\r\n    \r\n    RoleService = {\r\n        selectRole : function(roleId){\r\n            RoleService.toggleRole(roleId, true);\r\n        },\r\n        \r\n        selectRoleByLabel : function (roleLabel){\r\n            angular.forEach($sessionStorage.sessionRoles, function(role) {\r\n                if(role.label == roleLabel) return RoleService.selectRole(role.id);\r\n            });\r\n        },\r\n        \r\n        toggleRole : function(roleId, set){\r\n            angular.forEach($sessionStorage.sessionRoles, function(role) {\r\n                if (role.id == roleId) {\r\n                    if(set === undefined) role.active = !role.active;\r\n                    else role.active = set;\r\n                }\r\n            });\r\n        },\r\n        \r\n        getActiveRoleIds : function(){\r\n            var roleIds = [];\r\n            angular.forEach($sessionStorage.sessionRoles, function(role) {\r\n                if (role.active === true) {\r\n                    roleIds.push(role.id);\r\n                }\r\n            });\r\n            return roleIds;\r\n        },\r\n        \r\n        deactivateAllRoles : function(){\r\n            angular.forEach($sessionStorage.sessionRoles, function(role) {\r\n                role.active = false;\r\n            });\r\n        },\r\n        \r\n        setActiveRoles : function(){\r\n            return Restangular.all('app/roles').patch($sessionStorage.sessionRoles);\r\n        }\r\n    };\r\n    \r\n    return RoleService;\r\n});\r\n","angular.module('AmpersandApp')\r\n.service('NotificationService', function($localStorage, $sessionStorage, $timeout, Restangular){\r\n    // Initialize notifications container\r\n    let notifications = {\r\n        'signals' : [],\r\n        'invariants' : [],\r\n        'infos' : [],\r\n        'successes' : [],\r\n        'warnings' : [],\r\n        'errors' : []\r\n    };\r\n    \r\n    let NotificationService = {\r\n        notifications : notifications,\r\n        \r\n        // Function to get notifications again\r\n        getNotifications : function(){\r\n            return Restangular\r\n            .one('app/notifications')\r\n            .get()\r\n            .then(\r\n                function(data){\r\n                    data = data.plain();\r\n                    NotificationService.updateNotifications(data);\r\n                },\r\n                function(){\r\n                    NotificationService.addError('Something went wrong while getting notifications');\r\n                }\r\n            );\r\n        },\r\n\r\n        checkAllRules : function(){\r\n            return Restangular\r\n            .one('admin/ruleengine/evaluate/all')\r\n            .get()\r\n            .then(\r\n                function(data){\r\n                    data = data.plain();\r\n                    NotificationService.addSuccess('Evaluated all rules.');\r\n                    NotificationService.updateNotifications(data);\r\n                },function(){\r\n                    NotificationService.addError('Something went wrong while evaluating all rules');\r\n                }\r\n            );\r\n        },\r\n        \r\n        // Function to update notifications after api response\r\n        updateNotifications : function(data){\r\n            if(data === undefined) return;\r\n            \r\n            // Overwrite\r\n            notifications.signals = data.signals;\r\n            notifications.invariants = data.invariants;\r\n            \r\n            // Merge\r\n            notifications.infos = notifications.infos.concat(data.infos);\r\n            notifications.successes = notifications.successes.concat(data.successes);\r\n            notifications.warnings = notifications.warnings.concat(data.warnings);\r\n            notifications.errors = notifications.errors.concat(data.errors);\r\n            \r\n            if($localStorage.notificationPrefs.switchAutoHideSuccesses){\r\n                $timeout(function() {\r\n                    notifications.successes = [];\r\n                }, 3000);\r\n            }\r\n        },\r\n        \r\n        addSuccess : function(message){\r\n            notifications.successes.push({\r\n                'message' : message,\r\n                'count' : 1\r\n            });\r\n            \r\n            // TODO: move timeout function here for auto hide successes\r\n        },\r\n        \r\n        addError : function(message, code, persistent, details){\r\n            code = typeof code !== undefined ? code : null;\r\n            persistent = typeof persistent !== undefined ? persistent : false;\r\n            details = typeof details !== undefined ? details : false;\r\n            \r\n            let alreadyExists = false;\r\n            let arr = notifications.errors;\r\n            for (let i = 0; i < arr.length; i++) {\r\n                if (arr[i].message == message) {\r\n                    arr[i].count += 1;\r\n                    arr[i].code = code;\r\n                    arr[i].persistent = persistent;\r\n                    arr[i].details = details;\r\n                    alreadyExists = true;\r\n                }\r\n            }\r\n            if(!alreadyExists) notifications.errors.push({\r\n                'message' : message,\r\n                'code' : code,\r\n                'count' : 1,\r\n                'persistent' : persistent,\r\n                'details' : details\r\n            });\r\n        },\r\n        \r\n        addWarning : function(message){\r\n            let alreadyExists = false;\r\n            let arr = notifications.warnings;\r\n            for (var i = 0; i < arr.length; i++) {\r\n                if (arr[i].message == message) {\r\n                    arr[i].count += 1;\r\n                    alreadyExists = true;\r\n                }\r\n            }\r\n            if(!alreadyExists) notifications.warnings.push({\r\n                'message' : message,\r\n                'count' : 1\r\n            });\r\n        },\r\n        \r\n        addInfo : function(message){\r\n            let alreadyExists = false;\r\n            let arr = notifications.infos;\r\n            for (var i = 0; i < arr.length; i++) {\r\n                if (arr[i].message == message) {\r\n                    arr[i].count += 1;\r\n                    alreadyExists = true;\r\n                }\r\n            }\r\n            if(!alreadyExists) notifications.infos.push({\r\n                'message' : message,\r\n                'count' : 1\r\n            });\r\n        }\r\n    };\r\n    \r\n    return NotificationService;\r\n});","angular.module('AmpersandApp')\r\n.controller('NotificationCenterController', function ($scope, $route, Restangular, $localStorage, NotificationService) {\r\n    \r\n    $scope.localStorage = $localStorage;\r\n    $scope.notifications = NotificationService.notifications;\r\n    \r\n    // Hide success-, error-, warnings-, info- and invariant violation messages (not signals) upon route change\r\n    $scope.$on(\"$routeChangeSuccess\", function(){\r\n        $scope.notifications.successes = [];\r\n        $scope.notifications.errors = $scope.notifications.errors.filter(function (error){\r\n            if(error.persistent){\r\n                error.persistent = false;\r\n                return true;\r\n            }\r\n            else return false;\r\n        });\r\n        $scope.notifications.warnings = [];\r\n        $scope.notifications.infos = [];\r\n        $scope.notifications.invariants = [];\r\n    });\r\n    \r\n    // Function to close notifications\r\n    $scope.closeAlert = function(alerts, index) {\r\n        alerts.splice(index, 1);\r\n    };\r\n    \r\n});\r\n","angular.module('AmpersandApp')\r\n.filter('unsafe', function($sce){\r\n    return $sce.trustAsHtml;\r\n});\r\n","angular.module('AmpersandApp')\r\n.directive('myNavToInterfaces', function(){\r\n    return {\r\n        restrict : 'E',\r\n        scope : {resource : '=', target : '@'}, // '=' => two-way bind, '@' => evaluates string (use {{}} in html) \r\n        templateUrl : 'app/src/shared/myNavTo/myNavToInterfaces.html',\r\n        transclude : true\r\n    };\r\n});\r\n","angular.module('AmpersandApp')\r\n.directive('myNavToOtherInterfaces', function(){\r\n    return {\r\n        restrict : 'E',\r\n        scope  : {resource : '=', target : '@'}, // '=' => two-way bind, '@' => evaluates string (use {{}} in html) \r\n        templateUrl : 'app/src/shared/myNavTo/myNavToOtherInterfaces.html'\r\n    };\r\n});\r\n","angular.module('AmpersandApp')\r\n.value('cgBusyDefaults',{\r\n    message:'Loading...',\r\n    backdrop: true,\r\n    //templateUrl: 'my_custom_template.html',\r\n    //delay: 500, // in ms\r\n    minDuration: 500, // in ms\r\n    // wrapperClass: 'my-class my-class2'\r\n});\r\n","// when using minified angular modules, use module('myApp', []).controller('MyController', ['myService', function (myService) { ...\r\nangular.module('AmpersandApp', ['ngResource', 'ngRoute', 'ngSanitize', 'restangular', 'ui.bootstrap', 'uiSwitch', 'cgBusy', 'siTable', 'ui.codemirror', 'ngStorage', 'angularFileUpload', 'ui.bootstrap.datetimepicker', 'hc.marked'])\r\n.config(function($routeProvider, $locationProvider) {\r\n    $routeProvider\r\n        // default start page\r\n        .when('/', { \r\n            controller : '',\r\n            templateUrl : 'app/src/shared/home.html',\r\n            interfaceLabel : 'Home'\r\n            })\r\n        // installer page\r\n        .when('/admin/installer', {\r\n            controller : 'InstallerController',\r\n            templateUrl : 'app/src/admin/installer.html',\r\n            interfaceLabel : 'Installer'\r\n            })\r\n        .when('/404', {\r\n            templateUrl: 'app/src/shared/404.html',\r\n            interfaceLabel: '404'\r\n            })\r\n        .otherwise({redirectTo: '/404'});\r\n    \r\n    $locationProvider.hashPrefix(''); // see: https://stackoverflow.com/questions/41211875/angularjs-1-6-0-latest-now-routes-not-working\r\n}).config(function(RestangularProvider) {\r\n    \r\n    RestangularProvider.setBaseUrl('api/v1'); // Generate: path to API folder\r\n    RestangularProvider.setDefaultHeaders({\"Content-Type\": \"application/json\"});\r\n    // RestangularProvider.setPlainByDefault(true); available from Restangular v1.5.3\r\n    \r\n}).run(function(Restangular, $rootScope, $location, $route, NotificationService, RoleService, NavigationBarService){\r\n\r\n    Restangular.addFullRequestInterceptor(function(element, operation, what, url, headers, params){\r\n        //params.navIfc = true;\r\n        //params.metaData = true;\r\n        return params;\r\n    });\r\n    \r\n    Restangular.addResponseInterceptor(function(data, operation, what, url, response, deferred){\r\n        if(operation != 'get' && operation != 'getList' && data.sessionRefreshAdvice) NavigationBarService.refreshNavBar();\r\n\t\tif((data || {}).navTo != null) $location.url(data.navTo);\r\n        \r\n        return data;\r\n    });\r\n    \r\n    Restangular.setErrorInterceptor(function(response, deferred, responseHandler) {\r\n        // 401: Unauthorized\r\n        if(response.status == 401) {\r\n            RoleService.deactivateAllRoles();\r\n            $location.path(''); // TODO: redirect to login page (if exists)\r\n        }\r\n        \r\n        var message;\r\n        var details;\r\n        if(typeof response.data === 'object'){\r\n            if(response.data.error == 404) {\r\n                NotificationService.addInfo(response.data.msg || 'Resource not found');\r\n            } else {\r\n                message = response.data.msg || response.statusText; // if empty response message, take statusText\r\n                NotificationService.addError(message, response.status, true, response.data.html);\r\n            }\r\n            \r\n            if(response.data.notifications !== undefined) NotificationService.updateNotifications(response.data.notifications); \r\n        }else{\r\n            message = response.status + ' ' + response.statusText;\r\n            details = response.data; // html content is excepted\r\n            NotificationService.addError(message, response.status, true, details);\r\n        }\r\n        \r\n        return true; // proceed with success or error hooks of promise\r\n    });\r\n    \r\n    $rootScope.getCurrentDateTime = function (){\r\n        return new Date();\r\n    };\r\n    \r\n    // Add feature to $location.url() function to be able to prevent reloading page (set reload param to false)\r\n    var original = $location.url;\r\n    $location.url = function (url, reload) {\r\n        if (reload === false) {\r\n            var lastRoute = $route.current;\r\n            var un = $rootScope.$on('$locationChangeSuccess', function () {\r\n                $route.current = lastRoute;\r\n                un();\r\n            });\r\n        }\r\n        return original.apply($location, [url]);\r\n    };\r\n});\r\n\nangular.module('uiSwitch', [])\r\n\r\n.directive('switch', function(){\r\n  return {\r\n    restrict: 'AE'\r\n  , replace: true\r\n  , transclude: true\r\n  , template: function(element, attrs) {\r\n      var html = '';\r\n      html += '<a href=\"\"';\r\n      html +=   (attrs.ngModel && !attrs.ngClick) ? ' ng-click=\"' + attrs.ngModel + '=!' + attrs.ngModel + '\"' : '';\r\n      html += '>';\r\n      html += '<span';\r\n      html +=   ' class=\"switch' + (attrs.class ? ' ' + attrs.class : '') + '\"';\r\n      html +=   ' ng-class=\"{ checked:' + attrs.ngModel + ' }\"';\r\n      html +=   '>';\r\n      html +=   '<small></small>';\r\n      html += '</span>';\r\n      html += '<span ng-transclude></span>';\r\n      html += '</a>';\r\n      return html;\r\n    }\r\n  }\r\n});\n// Controller for extension app in navigation bar\r\nangular.module('AmpersandApp')\r\n.controller('ExecEngineController', function ($scope, Restangular, NotificationService) {\r\n    $scope.run = function (){\r\n        Restangular.one('admin/execengine/run').get()\r\n        .then(\r\n            function(data){ // on success\r\n                data = data.plain();\r\n                NotificationService.updateNotifications(data);\r\n            }\r\n        );\r\n    };\r\n});\r\n\nangular.module('AmpersandApp')\r\n.controller('InstallerController', function ($scope, Restangular, NotificationService, RoleService) {\r\n    $scope.installing = false;\r\n    $scope.installed = false;\r\n    \r\n    $scope.install = function(defPop){\r\n        $scope.installing = true;\r\n        $scope.installed = false;\r\n        Restangular.one('admin/installer').get({defaultPop : defPop}).then(function(data) {\r\n            data = data.plain();\r\n            NotificationService.updateNotifications(data);\r\n            \r\n            // deactive all roles\r\n            RoleService.deactivateAllRoles();\r\n            \r\n            $scope.installing = false;\r\n            $scope.installed = true;\r\n        }, function(){\r\n            $scope.installing = false;\r\n            $scope.installed = false;\r\n        });\r\n    };\r\n});\r\n\nvar app = angular.module('AmpersandApp');\r\napp.requires[app.requires.length] = 'angularFileUpload'; // add angularFileUpload to dependency list\r\napp.config(function($routeProvider) {\r\n    $routeProvider\r\n        .when('/ext/importer', {\r\n            controller : 'PopulationImportController',\r\n            templateUrl : 'app/src/importer/importer.html',\r\n            interfaceLabel : 'Population importer'\r\n        });\r\n}).service('ImportService', function(FileUploader, NotificationService){\r\n    let uploader = new FileUploader({\r\n        url: 'api/v1/admin/import'\r\n    });\r\n\r\n    uploader.onSuccessItem = function(fileItem, response, status, headers) {\r\n        NotificationService.updateNotifications(response.notifications);\r\n    };\r\n    \r\n    uploader.onErrorItem = function(item, response, status, headers){\r\n        let message;\r\n        let details;\r\n        if(typeof response === 'object'){\r\n            message = response.msg || 'Error while importing';\r\n            NotificationService.addError(message, status, true);\r\n            \r\n            if(response.notifications !== undefined) NotificationService.updateNotifications(response.notifications); \r\n        }else{\r\n            message = status + ' Error while importing';\r\n            details = response; // html content is excepted\r\n            NotificationService.addError(message, status, true, details);\r\n        }\r\n    };\r\n    \r\n    return {uploader : uploader};\r\n}).controller('PopulationImportController', function ($scope, ImportService) {\r\n    $scope.uploader = ImportService.uploader;\r\n});\r\n\nangular.module('AmpersandApp')\r\n.controller('AtomicController', function($scope, ResourceService){\r\n    \r\n    /*\r\n     * Object to temporary store value/resourceId to add to list\r\n     * Value/resourceId is stored as property of 'selected' obj. This is needed to pass it around by reference\r\n     */\r\n    $scope.selected = {};\r\n    \r\n    $scope.saveItem = ResourceService.saveItem; // function(resource, ifc, patchResource)\r\n    \r\n    $scope.addItem = ResourceService.addItem; // function(resource, ifc, selected, patchResource)\r\n    \r\n    $scope.removeItem = ResourceService.removeItem; // function(resource, ifc, index, patchResource)\r\n    \r\n    $scope.remove = ResourceService.removeResource; // function(ifc, resource, patchResource)\r\n    \r\n    $scope.delete = ResourceService.deleteResource; // function(ifc, resource)\r\n});\r\n\nangular.module('AmpersandApp')\r\n.controller('AtomicDateController', function ($scope, ResourceService) {\r\n    \r\n    $scope.isOpen = false;\r\n    \r\n    $scope.openDatepicker = function($event){\r\n        $event.preventDefault();\r\n        $event.stopPropagation();\r\n        $scope.isOpen = true;\r\n    };\r\n    \r\n    // Adds leading 0 if necesarry. Returns 2 digits.\r\n    function pad(number) {\r\n        var r = String(number);\r\n        if ( r.length === 1 ) {\r\n            r = '0' + r;\r\n        }\r\n        return r;\r\n    }\r\n    \r\n    function modifyToJSON(obj){\r\n        if(obj !== null){\r\n            obj.toJSON = function(){\r\n                return this.getUTCFullYear() + \r\n                    '-' + pad(this.getMonth() + 1) + // The getMonth() method returns the month in the specified date according to local time, as a zero-based value (where zero indicates the first month of the year).\r\n                    '-' + pad(this.getDate());\r\n            };\r\n        }\r\n    }\r\n    \r\n    $scope.selected = { value : ''}; // an empty object for temporary storing the input values\r\n    \r\n    $scope.saveDateItem = function(obj, property, patchResource){\r\n        modifyToJSON(obj[property]);\r\n        ResourceService.saveItem(obj, property, patchResource);\r\n    };\r\n    \r\n    $scope.addDateItem = function(obj, property, selected, patchResource){\r\n        if(selected.value !== ''){\r\n            modifyToJSON(selected.value);\r\n            ResourceService.addItem(obj, property, selected, patchResource);\r\n        }else{\r\n            console.log('Empty date selected');\r\n        }\r\n    };\r\n});\r\n\nangular.module('AmpersandApp')\r\n.controller('AtomicTypeAheadController', function($scope, Restangular, ResourceService){\r\n    \r\n    /*\r\n     * Object to temporary store value/resourceId to add to list\r\n     * Value/resourceId is stored as property of 'selected' obj. This is needed to pass it around by reference\r\n     */\r\n    $scope.selected = {};\r\n    \r\n    $scope.hasNoResults = false;\r\n    \r\n    /*\r\n     * Typeahead object is declared in interface.controller.js\r\n     * Thereby typeahead is called only once for every resourceType per interface\r\n     */\r\n    // $scope.typeahead = {};\r\n    \r\n    /*\r\n     * Typeahead functionality\r\n     * $scope.typeahead is initiated in InterfaceController to be able to reuse typeahead data\r\n     */\r\n    $scope.getTypeahead = function(resourceType, forceGetCall){\r\n        forceGetCall = typeof forceGetCall !== 'undefined' ? forceGetCall : false;\r\n\r\n        // Only if not yet set\r\n        if(typeof $scope.typeahead[resourceType] === 'undefined' || forceGetCall){\r\n            $scope.typeahead[resourceType] = Restangular.all('resource/' + resourceType).getList().$object;\r\n        }\r\n    };\r\n    \r\n    $scope.typeaheadOnSelect = function ($item, $model, $label, resource, ifc, patchResource){\r\n        if(typeof $item._id_ === 'undefined') console.log('Resource id undefined');\r\n        else if($item._id_ === '') console.log('Empty resource id provided');\r\n        else{\r\n            if(Array.isArray(resource[ifc])){\r\n                // Construct patch(es)\r\n                patch = ResourceService.createPatch('add', resource, patchResource, ifc, $item._id_);\r\n                ResourceService.addPatches(patchResource, [patch])\r\n                .then(function(data){\r\n                    // Adapt in js model\r\n                    if(!data.saved) resource[ifc].push(angular.copy($item));\r\n                });\r\n                \r\n            }else if(resource[ifc] === null){\r\n                // Construct patch(es)\r\n                patch = ResourceService.createPatch('replace', resource, patchResource, ifc, $item._id_);\r\n                ResourceService.addPatches(patchResource, [patch])\r\n                .then(function(data){\r\n                    // Adapt js model\r\n                    if(!data.saved) resource[ifc] = angular.copy($item);\r\n                });\r\n            }\r\n            else console.log('Error: Property already set and/or not defined');\r\n            \r\n            $scope.hasNoResults = false;\r\n        }\r\n        // Empty selected input\r\n        $scope.selected.value = '';\r\n    };\r\n    \r\n    $scope.typeAheadCreate = function (resource, ifc, selected, patchResource, resourceType){\r\n        if(Array.isArray(resource[ifc])) { \r\n            ResourceService.addItem(resource, ifc, selected, patchResource).then(\r\n                function(){\r\n                    $scope.getTypeahead(resourceType, true);\r\n                }\r\n            );\r\n        } else if(resource[ifc] === null) {\r\n            resource[ifc] = selected.value;\r\n            ResourceService.saveItem(resource, ifc, patchResource);\r\n        } else {\r\n            console.log('Error: Property already set and/or not defined');\r\n        }\r\n    };\r\n});\r\n\nangular.module('AmpersandApp')\r\n.controller('AtomicUploadFileController', function($scope, FileUploader, NotificationService){\r\n    \r\n    // File uploader stuff\r\n    $scope.FileUploader = new FileUploader({\r\n        alias : 'file', // fieldname as used in $_FILES['file']\r\n        formData : [],\r\n        removeAfterUpload : true,\r\n        autoUpload : true\r\n    });\r\n    \r\n    $scope.FileUploader.onSuccessItem = function(fileItem, response, status, headers){\r\n        NotificationService.updateNotifications(response.notifications);\r\n        \r\n        // Add response content (newly created FileObject) to ifc list in resource\r\n        fileItem.resource[fileItem.ifc].push(response.content);\r\n    };\r\n    \r\n    $scope.FileUploader.onErrorItem = function(item, response, status, headers){\r\n        NotificationService.addError(response.error.message, response.error.code, true);\r\n    };\r\n});\r\n\nangular.module('AmpersandApp')\r\n.controller('BoxController', function($scope, ResourceService){\r\n    \r\n    // Function to create a new resource (does a POST)\r\n    $scope.createResource = ResourceService.createResource; // function(resource, ifc, callingObj, prepend)\r\n    \r\n    // Function to save certain attributes changes of a resource (does a PATCH)\r\n    $scope.save = ResourceService.saveResource; // function(resource)\r\n    \r\n    // Function to cancel unsaved edits (does a GET)\r\n    $scope.cancel = ResourceService.cancelResource; // function(resource)\r\n    \r\n    // Function to remove a resource from an interface (list)\r\n    $scope.remove = ResourceService.removeResource; // function(ifc, resource, patchResource)\r\n    \r\n    // Function to delete a resource\r\n    $scope.delete = ResourceService.deleteResource; // function(ifc, resource)\r\n});\r\n\nangular.module('AmpersandApp')\r\n.controller('InterfaceController', function($scope, $location, ResourceService){\r\n    /*\r\n     * An empty object for typeahead functionality.\r\n     * Defined here so it can be reused in an interface\r\n     * Prevents multiple calls for the same resourceType\r\n     */\r\n    $scope.typeahead = {};\r\n    \r\n    // Detects location changes and checks if there are unsaved changes\r\n    $scope.$on(\"$locationChangeStart\", function(event, next, current){\r\n        if(ResourceService.checkRequired()){\r\n            confirmed = confirm(\"You have unsaved edits. Do you wish to leave?\");\r\n            if (event && !confirmed) event.preventDefault();\r\n            else if(event && confirmed) ResourceService.emptyUpdatedResources();\r\n            else console.log('Someting went wrong. Cannot determine action after locationChangeStart');\r\n        }\r\n    });\r\n    \r\n    // Function to change location to create a new resource\r\n    $scope.newResource = function(){\r\n        $location.url('/' + ifcName + '?new');\r\n    };\r\n    \r\n    // Function (reference) to check if there are pending promises for a resource\r\n    $scope.pendingPromises = ResourceService.pendingPromises;\r\n});\r\n\nangular.module('AmpersandApp')\r\n.directive('myBluronenter', function() {\r\n    return function(scope, element, attrs) {\r\n        element.bind(\"keydown keypress\", function(event) {\r\n            if(event.which === 13) { // 13 = Carriage return\r\n                event.target.blur();\r\n\r\n                event.preventDefault();\r\n            }\r\n        });\r\n    };\r\n});\r\n\nangular.module('AmpersandApp')\r\n.directive('myShowonhoverBox', function (){\r\n    return {\r\n        link : function(scope, element, attrs) {\r\n            if(!element.closest('.box').hasClass('my-showonhover-box-show')) element.hide(); // default hide\r\n            \r\n            element.closest('.box').bind('mouseenter', function() {\r\n                element.closest('.box').addClass('my-showonhover-box-show');\r\n                element.show();\r\n            });\r\n            element.closest('.box').bind('mouseleave', function() {\r\n                element.closest('.box').removeClass('my-showonhover-box-show');\r\n                element.hide();\r\n            });\r\n        }\r\n    };\r\n});\r\n\nangular.module('AmpersandApp')\r\n.service('ResourceService', function($localStorage, $timeout, $location, Restangular, NotificationService, $q){\r\n    // http://blog.thoughtram.io/angular/2015/07/07/service-vs-factory-once-and-for-all.html\r\n    \r\n    let updatedResources = []; // contains list with updated resource objects in this interface. Used to check if there are uncommmitted changes (patches in cache)\r\n    \r\n    let ResourceService = {\r\n        /**\r\n         * Get resource data given a certain interface (ifc)\r\n         * \r\n         * @param {Object} resource\r\n         * @param {string} ifc\r\n         * @param {Object} callingObj will be used for loading indicator\r\n         * @returns {Promise}\r\n         */\r\n        getResource : function(resource, ifc, callingObj){\r\n            promise = Restangular\r\n            .one(resource._path_ + '/' + ifc)\r\n            .get()\r\n            .then(function(data){\r\n                try {\r\n                    data = data.plain();\r\n                }catch(error){}\r\n                if($.isEmptyObject(data)) NotificationService.addInfo('No results found');\r\n                else if(resource[ifc] === null || Array.isArray(resource[ifc])) resource[ifc] = data;\r\n                else angular.extend(resource[ifc], data);\r\n                \r\n                ResourceService.initResourceMetaData(resource);\r\n\r\n                return resource;\r\n            });\r\n            \r\n            // Add promise to loading list\r\n            if(!Array.isArray(callingObj._loading_)) callingObj._loading_ = [];\r\n            callingObj._loading_.push(promise);\r\n            \r\n            return promise;\r\n        },\r\n\r\n        /**\r\n         * Patch the given resource by calling the API and sending the list of stored patches \r\n         * \r\n         * @param {Object} resource\r\n         * @returns {Promise}\r\n         */\r\n        saveResource : function(resource){\r\n            promise = Restangular\r\n            .one(resource._path_)\r\n            .patch(resource._patchesCache_, {})\r\n            .then(function(data) {\r\n                data = data.plain();\r\n                \r\n                // Update resource data\r\n                if(resource._isRoot_) resource.get();\r\n                else resource = angular.extend(resource, data.content);\r\n                \r\n                // Update visual feedback (notifications and buttons)\r\n                ResourceService.processResponse(resource, data);\r\n\r\n                return {resource : resource, saved: true};\r\n            });\r\n\r\n            // Add promise to loading list\r\n            if(!Array.isArray(resource._loading_)) resource._loading_ = [];\r\n            resource._loading_.push(promise);\r\n            \r\n            return promise;\r\n        },\r\n        \r\n        /**\r\n         * Cancel unsaved edits and get resource data\r\n         * \r\n         * @param {Object} resource\r\n         * @returns {Promise}\r\n         */\r\n        cancelResource : function(resource){\r\n            promise = Restangular\r\n            .one(resource._path_)\r\n            .get()\r\n            .then(function(data){\r\n                data = data.plain();\r\n                if($.isEmptyObject(data)) NotificationService.addInfo('No results found');\r\n                else angular.extend(resource, data);\r\n                \r\n                // Update visual feedback (notifications and buttons)\r\n                NotificationService.getNotifications();\r\n                ResourceService.initResourceMetaData(resource);\r\n\r\n                return resource;\r\n            });\r\n            \r\n            // Add promise to loading list\r\n            if(!Array.isArray(resource._loading_)) resource._loading_ = [];\r\n            resource._loading_.push(promise);\r\n            \r\n            return promise;\r\n        },\r\n        \r\n        /**\r\n         * Create (POST) a new resource to a certain interface list\r\n         * \r\n         * @param {Object} resource\r\n         * @param {string} ifc\r\n         * @param {Object} callingObj will be used for loading indicator\r\n         * @param {bool} prepend\r\n         * @returns {Promise}\r\n         */\r\n        createResource : function(resource, ifc, callingObj, prepend){\r\n            if(prepend === 'undefined') prepend = false;\r\n            \r\n            promise = Restangular\r\n            .one(resource._path_).all(ifc)\r\n            .post({}, {})\r\n            .then(function(data){\r\n                data = data.plain();\r\n                // Update visual feedback (notifications and buttons)\r\n                ResourceService.processResponse(callingObj, data);\r\n\r\n                newResource = data.content;\r\n                \r\n                // Add new resource to ifc\r\n                if(Array.isArray(resource[ifc])){ // non-uni = list\r\n                    if(prepend) resource[ifc].unshift(newResource);\r\n                    else resource[ifc].push(newResource);\r\n                }else{ // uni = object\r\n                    resource[ifc] = newResource;\r\n                }\r\n                \r\n                if(resource._isRoot_ && resource._id_ == '_NEW') $location.url('/' + ifc + '/'+ newResource._id_, false);\r\n\r\n                return newResource;\r\n            });\r\n\r\n            // Add promise to loading list\r\n            if(!Array.isArray(callingObj._loading_)) callingObj._loading_ = [];\r\n            callingObj._loading_.push(promise);\r\n            \r\n            return promise;\r\n        },\r\n        \r\n        /**\r\n         * Remove a resource from a certain interface list\r\n         * \r\n         * @param {Object} parent\r\n         * @param {string} ifc\r\n         * @param {Object} resource\r\n         * @param {bool} patchResource\r\n         * @returns {Promise}\r\n         */\r\n        removeResource : function(parent, ifc, resource, patchResource){\r\n            // Construct patch(es)\r\n            patch = ResourceService.createPatch('remove', resource, patchResource);\r\n\r\n            // Execute patch\r\n            return ResourceService\r\n            .addPatches(patchResource, [patch])\r\n            .then(function(data){\r\n                // Adapt js model\r\n                if(Array.isArray(parent[ifc])) parent[ifc].splice(parent[ifc].indexOf(resource), 1); // non-uni = list\r\n                else parent[ifc] = null; // uni = object\r\n            });\r\n        },\r\n        \r\n        /**\r\n         * Delete a resource\r\n         * \r\n         * @param {Object} parent\r\n         * @param {string} ifc\r\n         * @param {Object} resource to delete\r\n         * @returns {Promise}\r\n         */\r\n        deleteResource : function(parent, ifc, resource){\r\n            if(confirm('Are you sure?')){\r\n                promise = Restangular\r\n                .one(resource._path_)\r\n                .remove({})\r\n                .then(function(data){\r\n                    data = data.plain();\r\n                    // Update visual feedback (notifications and buttons)\r\n                    NotificationService.updateNotifications(data.notifications);\r\n                    \r\n                    // Remove resource from ifc\r\n                    if(Array.isArray(parent[ifc])) parent[ifc].splice(parent[ifc].indexOf(resource), 1); // non-uni = list\r\n                    else parent[ifc] = null; // uni = object\r\n\r\n                    return parent;\r\n                });\r\n\r\n                // Add promise to loading list\r\n                if(!Array.isArray(resource._loading_)) resource._loading_ = [];\r\n                resource._loading_.push(promise);\r\n                \r\n                return promise;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Save/patch a changed attribute\r\n         * \r\n         * @param {Object} resource\r\n         * @param {string} ifc\r\n         * @param {Object} patchResource\r\n         * @returns {Promise}\r\n         */\r\n        saveItem : function(resource, ifc, patchResource){\r\n            // Construct patch(es)\r\n            if(typeof resource[ifc] === 'undefined' || resource[ifc] === '') {\r\n                value = null;\r\n            } else {\r\n                value = resource[ifc];\r\n            }\r\n            patch = ResourceService.createPatch('replace', resource, patchResource, ifc, value);\r\n\r\n            // Register patch\r\n            return ResourceService.addPatches(patchResource, [patch]);\r\n        },\r\n        \r\n        /**\r\n         * Add an item to an interface list\r\n         * \r\n         * @param {Object} resource\r\n         * @param {string} ifc\r\n         * @param {Object} selected item to add to the list\r\n         * @param {Object} patchResource\r\n         * @returns {Promise}\r\n         */\r\n        addItem : function(resource, ifc, selected, patchResource){\r\n            if(typeof selected.value === 'undefined') {\r\n                //console.log('Value undefined');\r\n                return $q.reject('Value undefined');\r\n            } else if(selected.value === '') {\r\n                //console.log('Empty value selected');\r\n                return $q.reject('Empty value selected');\r\n            } else if(!Array.isArray(resource[ifc])) {\r\n                //console.log('Error: trying to add item to non-array');\r\n                return $q.reject('Error: trying to add item to non-array');\r\n            } else{\r\n                // Adapt in js model\r\n                resource[ifc].push(selected.value);\r\n                \r\n                // Construct patch(es)\r\n                patch = ResourceService.createPatch('add', resource, patchResource, ifc, selected.value);\r\n                return ResourceService.addPatches(patchResource, [patch]).then(function(data){\r\n                    // Reset selected value\r\n                    delete(selected.value);\r\n                    return data;\r\n                });\r\n            }\r\n        },\r\n        \r\n        /**\r\n         * Remove an item from an interface list\r\n         * \r\n         * @param {Object} resource\r\n         * @param {string} ifc\r\n         * @param {int} index\r\n         * @param {Object} patchResource\r\n         * @returns {Promise}\r\n         */\r\n        removeItem : function(resource, ifc, index, patchResource){\r\n            // Construct patch(es)\r\n            value = resource[ifc][index];\r\n            patch = ResourceService.createPatch('remove', resource, patchResource, ifc, value);\r\n            \r\n            // Adapt js model\r\n            resource[ifc].splice(index, 1);\r\n\r\n            return ResourceService.addPatches(patchResource, [patch]);\r\n        },\r\n        \r\n        /**\r\n         * Construct patch object (with attributes 'op', 'path' and 'value')\r\n         * \r\n         * @param {string} operation choose from 'add', 'remove' or 'replace'\r\n         * @param {Object} resource\r\n         * @param {Object} patchResource\r\n         * @param {string} ifc\r\n         * @param {string} value\r\n         * @returns {Object}\r\n         */\r\n        createPatch : function(operation, resource, patchResource, ifc, value){\r\n            if(typeof patchResource === 'undefined') patchResource = resource;\r\n            pathLength = patchResource._path_.length;\r\n            \r\n            path = resource._path_.substring(pathLength);\r\n            if(typeof ifc !== 'undefined') path = path + '/' + ifc;\r\n            \r\n            if(typeof value === 'undefined') return { op : operation, path : path};\r\n            else return { op : operation, path : path, value : value};\r\n        },\r\n        \r\n        /**\r\n         * Add list of patches for given resource and call API (when auto-save is on)\r\n         * \r\n         * @param {Object} resource\r\n         * @param {Object[]} patches\r\n         * @returns {Promise}\r\n         */\r\n        addPatches : function(resource, patches){\r\n            // Add new patches to resource\r\n            if(!Array.isArray(resource._patchesCache_)) resource._patchesCache_ = [];\r\n            resource._patchesCache_ = resource._patchesCache_.concat(patches);\r\n            \r\n            // Add resource to updatedResources\r\n            if(updatedResources.indexOf(resource) === -1) updatedResources.push(resource);\r\n            \r\n            // Save if autoSave is enabled\r\n            if($localStorage.switchAutoSave) {\r\n                return ResourceService.saveResource(resource);\r\n            } else {\r\n                // Update visual feedback\r\n                ResourceService.setResourceStatus(resource, 'warning');\r\n                resource._showButtons_ = {'save' : true, 'cancel' : true};\r\n                return $q.resolve({resource : resource, saved : false});\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Returns if there are unsaved changes (i.e. patches that are not yet sent to the API)\r\n         * \r\n         * @returns {bool}\r\n         */\r\n        checkRequired : function(){ \r\n            updatedResources.reduce(function(prev, item, index, arr){\r\n                return prev || item._patchesCache_.length;\r\n            }, false);\r\n        },\r\n        \r\n        /**\r\n         * Clear list of updated resources\r\n         */\r\n        emptyUpdatedResources : function(){\r\n            updatedResources = [];\r\n        },\r\n        \r\n        /**\r\n         * Init/reset resource meta data\r\n         * \r\n         * @param {Object} resource\r\n         */\r\n        initResourceMetaData : function(resource){\r\n            resource._showButtons_ = {'save' : false, 'cancel' : false};\r\n            resource._patchesCache_ = [];\r\n            ResourceService.setResourceStatus(resource, 'default');\r\n        },\r\n        \r\n        /**\r\n         * Process response: i.e. set resource buttons and status\r\n         * \r\n         * @param {Object} resource\r\n         * @param {Object} response from API\r\n         * @returns {Object}\r\n         */\r\n        processResponse : function(resource, response){\r\n            NotificationService.updateNotifications(response.notifications);\r\n            \r\n            if(response.invariantRulesHold){\r\n                resource._showButtons_ = {'save' : false, 'cancel' : false};\r\n                resource._patchesCache_ = []; // empty patches cache\r\n                ResourceService.setResourceStatus(resource, 'success');\r\n                \r\n                // After 3 seconds, reset status to default\r\n                $timeout(function(){\r\n                    ResourceService.setResourceStatus(resource, 'default');\r\n                }, 3000);\r\n            }else{\r\n                resource._showButtons_ = {'save' : false, 'cancel' : true};\r\n                ResourceService.setResourceStatus(resource, 'danger');\r\n            }\r\n\r\n            return resource;\r\n        },\r\n        \r\n        /**\r\n         * Set resource status meta data\r\n         * \r\n         * @param {Object} resource\r\n         * @param {string} status choose from 'warning', 'danger', 'success' or 'default'\r\n         * @returns {Object}\r\n         */\r\n        setResourceStatus : function(resource, status){\r\n            // Reset all status properties\r\n            resource._status_ = { 'warning' : false,\r\n                                  'danger'  : false,\r\n                                  'default' : false,\r\n                                  'success' : false\r\n                                };\r\n            // Set status property\r\n            resource._status_[status] = true;\r\n            \r\n            return resource;\r\n        },\r\n        \r\n        /**\r\n         * Returns if resource has pending promises\r\n         * \r\n         * @param {Object} resource\r\n         * @returns {bool}\r\n         */\r\n        pendingPromises : function(resource){\r\n            if(!Array.isArray(resource._loading_)) return false; // empty array contains no pending promises\r\n            \r\n            return resource._loading_.some(function(val){\r\n                return val.$$state.status === 0; // promise status: 0 -> pending, 1 -> resolved, 2 -> rejected\r\n            });\r\n        }\r\n    };\r\n    \r\n    return ResourceService;\r\n});\r\n\nangular.module('AmpersandApp')\r\n.directive('myNavbarResize', function ($window, $timeout, NavigationBarService) {\r\n    return function (scope, element) {\r\n        var w = angular.element($window);\r\n        \r\n        var resizeNavbar = function() {\r\n            $timeout(function(){\r\n                // moving ifc items from dropdown-menu to navbar itself\r\n                while($('#navbar-interfaces').width() < ($('#navbar-wrapper').width() - $('#navbar-options').width()) &&\r\n                        $('#navbar-interfaces-dropdown-menu').children().length > 0){\r\n                    $(\"#navbar-interfaces-dropdown-menu\").children().first().appendTo(\"#navbar-interfaces\");\r\n                }\r\n                \r\n                // moving ifc items from navbar to dropdown-menu\r\n                while($('#navbar-interfaces').width() > ($('#navbar-wrapper').width() - $('#navbar-options').width())){\r\n                    $(\"#navbar-interfaces\").children().last().prependTo(\"#navbar-interfaces-dropdown-menu\");\r\n                    \r\n                    // show/hide dropdown menu for more interfaces (must be inside loop, because it affects the width of the navbar\r\n                    $('#navbar-interfaces-dropdown').toggleClass('hidden', $('#navbar-interfaces-dropdown-menu').children().length <= 0);\r\n                }\r\n                \r\n                // show/hide dropdown menu when possible\r\n                $('#navbar-interfaces-dropdown').toggleClass('hidden', $('#navbar-interfaces-dropdown-menu').children().length <= 0);\r\n            });\r\n        };\r\n        \r\n        // watch navbar\r\n        scope.$watch('NavigationBarService.navbar', function() {\r\n            resizeNavbar();\r\n        });\r\n        \r\n        // when window size gets changed\r\n        w.bind('resize', function () {        \r\n            resizeNavbar();\r\n        });\r\n        \r\n        // when page loads\r\n        resizeNavbar();\r\n    };\r\n});\r\n\nangular.module('AmpersandApp')\r\n.controller('NavigationBarController', function ($scope, $route, Restangular, $localStorage, $sessionStorage, $timeout, $location, NotificationService, RoleService, NavigationBarService) {\r\n    \r\n    $scope.$storage = $localStorage;\r\n    $scope.$sessionStorage = $sessionStorage;\r\n    $scope.defaultSettings = NavigationBarService.defaultSettings;\r\n    $scope.loadingNavBar = [];\r\n    $scope.navbar = NavigationBarService.navbar;\r\n    \r\n    $scope.reload = function(){\r\n        $scope.loadingNavBar = [];\r\n        $scope.loadingNavBar.push(NavigationBarService.refreshNavBar());\r\n        $route.reload();\r\n    };\r\n\r\n    $scope.toggleRole = function(roleId, set){\r\n        RoleService.toggleRole(roleId, set);\r\n        $scope.loadingNavBar = [];\r\n        $scope.loadingNavBar.push(\r\n            RoleService.setActiveRoles()\r\n            .then(function(data){\r\n                NavigationBarService.refreshNavBar();\r\n            })\r\n        );\r\n    };\r\n\r\n    $scope.checkAllRules = NotificationService.checkAllRules;\r\n\r\n    $scope.createNewResource = function(resourceType, openWithIfc){\r\n        Restangular.one('resource').all(resourceType)\r\n        .post({}, {})\r\n        .then(\r\n            function(data){\r\n                // Jumps to interface and requests newly created resource\r\n                $location.url(openWithIfc + '/' + data._id_);\r\n            }\r\n        );\r\n    };\r\n    \r\n    $scope.resetSettings = function(){\r\n        // all off\r\n        angular.forEach($scope.$storage.notificationPrefs, \r\n            function(value, index, obj){\r\n                obj[index] = false;\r\n            }\r\n        );\r\n        $scope.$storage.switchAutoSave = false;\r\n        \r\n        $timeout(function() {\r\n            // reset to default        \r\n            NavigationBarService.resetNotificationSettings();\r\n            NavigationBarService.resetSwitchAutoSave();\r\n        }, 500);\r\n    };\r\n    \r\n    $scope.loadingNavBar.push(NavigationBarService.refreshNavBar());\r\n});\r\n\nangular.module('AmpersandApp')\r\n.service('NavigationBarService', function(Restangular, $localStorage, $sessionStorage, NotificationService){\r\n    let navbar = {};\r\n    let defaultSettings = {};\r\n\r\n    let service = {\r\n        navbar : navbar,\r\n        defaultSettings : defaultSettings,\r\n\r\n        refreshNavBar : function(){\r\n            return Restangular\r\n            .one('app/navbar')\r\n            .get()\r\n            .then(function(data){\r\n                data = data.plain();\r\n\r\n                angular.extend(navbar, data);\r\n                $sessionStorage.session = data.session;\r\n                $sessionStorage.sessionRoles = data.sessionRoles;\r\n                $sessionStorage.sessionVars = data.sessionVars;\r\n                angular.extend(defaultSettings, data.defaultSettings);\r\n                \r\n                // Default settings for notificationPrefs\r\n                if($localStorage.notificationPrefs === undefined){\r\n                    service.resetNotificationSettings();\r\n                }\r\n                // Default setting for switchAutoSave\r\n                if($localStorage.switchAutoSave === undefined){\r\n                    service.resetSwitchAutoSave();\r\n                }\r\n                \r\n                // Update notifications\r\n                NotificationService.updateNotifications(data.notifications);\r\n            }, function(error){\r\n                // on error\r\n            });\r\n        },\r\n\r\n        resetNotificationSettings : function(){\r\n            $localStorage.notificationPrefs = angular.extend($localStorage.notificationPrefs, service.defaultSettings.notifications);\r\n        },\r\n\r\n        resetSwitchAutoSave : function(){\r\n            $localStorage.switchAutoSave = service.defaultSettings.switchAutoSave;\r\n        }\r\n    };\r\n    \r\n    return service;\r\n});\r\n\nangular.module('AmpersandApp')\r\n.service('RoleService', function($sessionStorage, Restangular){\r\n    \r\n    /*\r\n     * Available roles are registered in $sessionStorage.sessionRoles\r\n     * A role has the following attributes: id, label, active\r\n     */\r\n    \r\n    RoleService = {\r\n        selectRole : function(roleId){\r\n            RoleService.toggleRole(roleId, true);\r\n        },\r\n        \r\n        selectRoleByLabel : function (roleLabel){\r\n            angular.forEach($sessionStorage.sessionRoles, function(role) {\r\n                if(role.label == roleLabel) return RoleService.selectRole(role.id);\r\n            });\r\n        },\r\n        \r\n        toggleRole : function(roleId, set){\r\n            angular.forEach($sessionStorage.sessionRoles, function(role) {\r\n                if (role.id == roleId) {\r\n                    if(set === undefined) role.active = !role.active;\r\n                    else role.active = set;\r\n                }\r\n            });\r\n        },\r\n        \r\n        getActiveRoleIds : function(){\r\n            var roleIds = [];\r\n            angular.forEach($sessionStorage.sessionRoles, function(role) {\r\n                if (role.active === true) {\r\n                    roleIds.push(role.id);\r\n                }\r\n            });\r\n            return roleIds;\r\n        },\r\n        \r\n        deactivateAllRoles : function(){\r\n            angular.forEach($sessionStorage.sessionRoles, function(role) {\r\n                role.active = false;\r\n            });\r\n        },\r\n        \r\n        setActiveRoles : function(){\r\n            return Restangular.all('app/roles').patch($sessionStorage.sessionRoles);\r\n        }\r\n    };\r\n    \r\n    return RoleService;\r\n});\r\n\nangular.module('AmpersandApp')\r\n.service('NotificationService', function($localStorage, $sessionStorage, $timeout, Restangular){\r\n    // Initialize notifications container\r\n    let notifications = {\r\n        'signals' : [],\r\n        'invariants' : [],\r\n        'infos' : [],\r\n        'successes' : [],\r\n        'warnings' : [],\r\n        'errors' : []\r\n    };\r\n    \r\n    let NotificationService = {\r\n        notifications : notifications,\r\n        \r\n        // Function to get notifications again\r\n        getNotifications : function(){\r\n            return Restangular\r\n            .one('app/notifications')\r\n            .get()\r\n            .then(\r\n                function(data){\r\n                    data = data.plain();\r\n                    NotificationService.updateNotifications(data);\r\n                },\r\n                function(){\r\n                    NotificationService.addError('Something went wrong while getting notifications');\r\n                }\r\n            );\r\n        },\r\n\r\n        checkAllRules : function(){\r\n            return Restangular\r\n            .one('admin/ruleengine/evaluate/all')\r\n            .get()\r\n            .then(\r\n                function(data){\r\n                    data = data.plain();\r\n                    NotificationService.addSuccess('Evaluated all rules.');\r\n                    NotificationService.updateNotifications(data);\r\n                },function(){\r\n                    NotificationService.addError('Something went wrong while evaluating all rules');\r\n                }\r\n            );\r\n        },\r\n        \r\n        // Function to update notifications after api response\r\n        updateNotifications : function(data){\r\n            if(data === undefined) return;\r\n            \r\n            // Overwrite\r\n            notifications.signals = data.signals;\r\n            notifications.invariants = data.invariants;\r\n            \r\n            // Merge\r\n            notifications.infos = notifications.infos.concat(data.infos);\r\n            notifications.successes = notifications.successes.concat(data.successes);\r\n            notifications.warnings = notifications.warnings.concat(data.warnings);\r\n            notifications.errors = notifications.errors.concat(data.errors);\r\n            \r\n            if($localStorage.notificationPrefs.switchAutoHideSuccesses){\r\n                $timeout(function() {\r\n                    notifications.successes = [];\r\n                }, 3000);\r\n            }\r\n        },\r\n        \r\n        addSuccess : function(message){\r\n            notifications.successes.push({\r\n                'message' : message,\r\n                'count' : 1\r\n            });\r\n            \r\n            // TODO: move timeout function here for auto hide successes\r\n        },\r\n        \r\n        addError : function(message, code, persistent, details){\r\n            code = typeof code !== undefined ? code : null;\r\n            persistent = typeof persistent !== undefined ? persistent : false;\r\n            details = typeof details !== undefined ? details : false;\r\n            \r\n            let alreadyExists = false;\r\n            let arr = notifications.errors;\r\n            for (let i = 0; i < arr.length; i++) {\r\n                if (arr[i].message == message) {\r\n                    arr[i].count += 1;\r\n                    arr[i].code = code;\r\n                    arr[i].persistent = persistent;\r\n                    arr[i].details = details;\r\n                    alreadyExists = true;\r\n                }\r\n            }\r\n            if(!alreadyExists) notifications.errors.push({\r\n                'message' : message,\r\n                'code' : code,\r\n                'count' : 1,\r\n                'persistent' : persistent,\r\n                'details' : details\r\n            });\r\n        },\r\n        \r\n        addWarning : function(message){\r\n            let alreadyExists = false;\r\n            let arr = notifications.warnings;\r\n            for (var i = 0; i < arr.length; i++) {\r\n                if (arr[i].message == message) {\r\n                    arr[i].count += 1;\r\n                    alreadyExists = true;\r\n                }\r\n            }\r\n            if(!alreadyExists) notifications.warnings.push({\r\n                'message' : message,\r\n                'count' : 1\r\n            });\r\n        },\r\n        \r\n        addInfo : function(message){\r\n            let alreadyExists = false;\r\n            let arr = notifications.infos;\r\n            for (var i = 0; i < arr.length; i++) {\r\n                if (arr[i].message == message) {\r\n                    arr[i].count += 1;\r\n                    alreadyExists = true;\r\n                }\r\n            }\r\n            if(!alreadyExists) notifications.infos.push({\r\n                'message' : message,\r\n                'count' : 1\r\n            });\r\n        }\r\n    };\r\n    \r\n    return NotificationService;\r\n});\nangular.module('AmpersandApp')\r\n.controller('NotificationCenterController', function ($scope, $route, Restangular, $localStorage, NotificationService) {\r\n    \r\n    $scope.localStorage = $localStorage;\r\n    $scope.notifications = NotificationService.notifications;\r\n    \r\n    // Hide success-, error-, warnings-, info- and invariant violation messages (not signals) upon route change\r\n    $scope.$on(\"$routeChangeSuccess\", function(){\r\n        $scope.notifications.successes = [];\r\n        $scope.notifications.errors = $scope.notifications.errors.filter(function (error){\r\n            if(error.persistent){\r\n                error.persistent = false;\r\n                return true;\r\n            }\r\n            else return false;\r\n        });\r\n        $scope.notifications.warnings = [];\r\n        $scope.notifications.infos = [];\r\n        $scope.notifications.invariants = [];\r\n    });\r\n    \r\n    // Function to close notifications\r\n    $scope.closeAlert = function(alerts, index) {\r\n        alerts.splice(index, 1);\r\n    };\r\n    \r\n});\r\n\nangular.module('AmpersandApp')\r\n.filter('unsafe', function($sce){\r\n    return $sce.trustAsHtml;\r\n});\r\n\nangular.module('AmpersandApp')\r\n.directive('myNavToInterfaces', function(){\r\n    return {\r\n        restrict : 'E',\r\n        scope : {resource : '=', target : '@'}, // '=' => two-way bind, '@' => evaluates string (use {{}} in html) \r\n        templateUrl : 'app/src/shared/myNavTo/myNavToInterfaces.html',\r\n        transclude : true\r\n    };\r\n});\r\n\nangular.module('AmpersandApp')\r\n.directive('myNavToOtherInterfaces', function(){\r\n    return {\r\n        restrict : 'E',\r\n        scope  : {resource : '=', target : '@'}, // '=' => two-way bind, '@' => evaluates string (use {{}} in html) \r\n        templateUrl : 'app/src/shared/myNavTo/myNavToOtherInterfaces.html'\r\n    };\r\n});\r\n\nangular.module('AmpersandApp')\r\n.value('cgBusyDefaults',{\r\n    message:'Loading...',\r\n    backdrop: true,\r\n    //templateUrl: 'my_custom_template.html',\r\n    //delay: 500, // in ms\r\n    minDuration: 500, // in ms\r\n    // wrapperClass: 'my-class my-class2'\r\n});\r\n\nangular.module('AmpersandApp').run(['$templateCache', function($templateCache) {$templateCache.put('app/src/admin/check-rules-menu-item.html','<a ng-click=\"checkAllRules()\"><span class=\"glyphicon glyphicon-check\"></span><span> (Re)evaluate all rules</span></a>');\n$templateCache.put('app/src/admin/execengine-menu-item.html','<a ng-controller=\"ExecEngineController\" href=\"\" ng-click=\"run()\">\\r\\n\\t<span class=\"glyphicon glyphicon-cog\"></span><span> Run execution engine</span>\\r\\n</a>');\n$templateCache.put('app/src/admin/exporter-menu-item.html','<a ng-href=\"api/v1/admin/export/all\">\\r\\n    <span class=\"glyphicon glyphicon-download\"></span><span> Population export</span>\\r\\n</a>');\n$templateCache.put('app/src/admin/installer-menu-item.html','<a href=\"#/admin/installer\">\\r\\n    <span class=\"glyphicon glyphicon-trash\"></span><span> Reinstall database</span>\\r\\n</a>');\n$templateCache.put('app/src/admin/installer.html','<div class=\"container-fluid\" id=\"Interface\">\\r\\n    <div class=\"jumbotron\">\\r\\n        <h1>Installer</h1>\\r\\n        <p>This action will reinstall the application and delete all content.</p>\\r\\n        <p>If provided, the initial population will be installed.</p>\\r\\n        <div class=\"btn-group\">\\r\\n            <button type=\"button\" ng-click=\"install(true)\" class=\"btn btn-lg\" ng-class=\"{\\'btn-danger\\' : (!installing && !installed), \\'btn-warning\\' : installing, \\'btn-success\\' : installed}\" ng-disabled=\"installing\">\\r\\n                <span ng-if=\"!installed && ! installing\">Reinstall application  </span>\\r\\n                <span ng-if=\"installing\">Application installing  </span>\\r\\n                <span ng-if=\"installed\">Application reinstalled  </span>\\r\\n                <img ng-if=\"installing\" ng-src=\"app/images/loading.gif\" style=\"height:20px;\"/>\\r\\n            </button>\\r\\n            <button type=\"button\" class=\"btn btn-lg dropdown-toggle\" ng-class=\"{\\'btn-danger\\' : (!installing && !installed), \\'btn-warning\\' : installing, \\'btn-success\\' : installed}\" ng-disabled=\"installing\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\\r\\n                <span class=\"caret\"></span>\\r\\n            </button>\\r\\n            <ul class=\"dropdown-menu\">\\r\\n                <li><a href=\"\" ng-click=\"install(true)\">Reinstall application</a></li>\\r\\n                <li><a href=\"\" ng-click=\"install(false)\">Reinstall application (without default population)</a></li>\\r\\n            </ul>\\r\\n        </div>\\r\\n    </div>\\r\\n</div>');\n$templateCache.put('app/src/importer/importer.html','<style>\\r\\n.my-drop-zone { \\r\\nborder: dotted 3px lightgray;\\r\\n}\\r\\n\\r\\n/* Default class applied to drop zones on over */\\r\\n.nv-file-over {\\r\\n\\tborder: dotted 3px red;\\r\\n}\\r\\n\\r\\n.another-file-over-class {\\r\\n\\tborder: dotted 3px green;\\r\\n}\\r\\n</style>\\r\\n<div class=\"container-fluid interface\">\\r\\n\\t<fieldset>\\r\\n\\t\\t<legend>Population importer</legend>\\r\\n\\t\\t<div class=\"row\">\\r\\n\\t\\t\\t<div class=\"col-md-3\" nv-file-drop=\"\" uploader=\"uploader\">\\r\\n\\t\\t\\t\\t<h3>Select files</h3>\\r\\n\\t\\t\\t\\t\\r\\n\\t\\t\\t\\t<div ng-show=\"uploader.isHTML5\">\\r\\n\\t\\t\\t\\t<!-- 3. nv-file-over uploader=\"link\" over-class=\"className\" -->\\r\\n\\t\\t\\t\\t\\t<div class=\"well my-drop-zone\" nv-file-over=\"\" uploader=\"uploader\">\\r\\n\\t\\t\\t\\t\\t\\tBase drop zone\\r\\n\\t\\t\\t\\t\\t</div>\\r\\n\\t\\t\\t\\t</div>\\r\\n\\t\\t\\t\\t\\r\\n\\t\\t\\t\\t<!-- Example: nv-file-select=\"\" uploader=\"{Object}\" options=\"{Object}\" filters=\"{String}\" -->\\r\\n\\t\\t\\t\\tMultiple\\r\\n\\t\\t\\t\\t<input type=\"file\" nv-file-select=\"\" uploader=\"uploader\" multiple  /><br/>\\r\\n\\t\\t\\t\\t\\r\\n\\t\\t\\t\\tSingle\\r\\n\\t\\t\\t\\t<input type=\"file\" nv-file-select=\"\" uploader=\"uploader\" />\\r\\n\\t\\t\\t</div>\\t\\r\\n\\t\\t\\t\\r\\n\\t\\t\\t<div class=\"col-md-9\" style=\"margin-bottom: 40px\">\\r\\n\\t\\r\\n\\t\\t\\t\\t<h3>Upload queue</h3>\\r\\n\\t\\t\\t\\t<p>Queue length: {{ uploader.queue.length }}</p>\\r\\n\\t\\t\\t\\t\\r\\n\\t\\t\\t\\t<table class=\"table\">\\r\\n\\t\\t\\t\\t\\t<thead>\\r\\n\\t\\t\\t\\t\\t\\t<tr>\\r\\n\\t\\t\\t\\t\\t\\t\\t<th width=\"50%\">Name</th>\\r\\n\\t\\t\\t\\t\\t\\t\\t<th ng-show=\"uploader.isHTML5\">Size</th>\\r\\n\\t\\t\\t\\t\\t\\t\\t<th ng-show=\"uploader.isHTML5\">Progress</th>\\r\\n\\t\\t\\t\\t\\t\\t\\t<th>Status</th>\\r\\n\\t\\t\\t\\t\\t\\t\\t<th>Actions</th>\\r\\n\\t\\t\\t\\t\\t\\t</tr>\\r\\n\\t\\t\\t\\t\\t</thead>\\r\\n\\t\\t\\t\\t\\t<tbody>\\r\\n\\t\\t\\t\\t\\t\\t<tr ng-repeat=\"item in uploader.queue\">\\r\\n\\t\\t\\t\\t\\t\\t\\t<td><strong>{{ item.file.name }}</strong></td>\\r\\n\\t\\t\\t\\t\\t\\t\\t<td ng-show=\"uploader.isHTML5\" nowrap>{{ item.file.size/1024/1024|number:2 }} MB</td>\\r\\n\\t\\t\\t\\t\\t\\t\\t<td ng-show=\"uploader.isHTML5\">\\r\\n\\t\\t\\t\\t\\t\\t\\t\\t<div class=\"progress\" style=\"margin-bottom: 0;\">\\r\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t<div class=\"progress-bar\" role=\"progressbar\" ng-style=\"{ \\'width\\': item.progress + \\'%\\' }\"></div>\\r\\n\\t\\t\\t\\t\\t\\t\\t\\t</div>\\r\\n\\t\\t\\t\\t\\t\\t\\t</td>\\r\\n\\t\\t\\t\\t\\t\\t\\t<td class=\"text-center\">\\r\\n\\t\\t\\t\\t\\t\\t\\t\\t<span ng-show=\"item.isSuccess\"><i class=\"glyphicon glyphicon-ok\"></i></span>\\r\\n\\t\\t\\t\\t\\t\\t\\t\\t<span ng-show=\"item.isCancel\"><i class=\"glyphicon glyphicon-ban-circle\"></i></span>\\r\\n\\t\\t\\t\\t\\t\\t\\t\\t<span ng-show=\"item.isError\"><i class=\"glyphicon glyphicon-remove\"></i></span>\\r\\n\\t\\t\\t\\t\\t\\t\\t\\t<span ng-show=\"item.isUploading\"><img src=\"app/images/loading.gif\" height=\"20\" width=\"20\"></span>\\r\\n\\t\\t\\t\\t\\t\\t\\t</td>\\r\\n\\t\\t\\t\\t\\t\\t\\t<td nowrap>\\r\\n\\t\\t\\t\\t\\t\\t\\t\\t<button type=\"button\" class=\"btn btn-success btn-xs\" ng-click=\"item.upload()\" ng-disabled=\"item.isReady || item.isUploading\">  <!-- Removed: \"|| item.isSuccess\" to enable the re-upload of a file.-->\\r\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t<span class=\"glyphicon glyphicon-upload\"></span> Upload\\r\\n\\t\\t\\t\\t\\t\\t\\t\\t</button>\\r\\n\\t\\t\\t\\t\\t\\t\\t\\t<button type=\"button\" class=\"btn btn-warning btn-xs\" ng-click=\"item.cancel()\" ng-disabled=\"!item.isUploading\">\\r\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t<span class=\"glyphicon glyphicon-ban-circle\"></span> Cancel\\r\\n\\t\\t\\t\\t\\t\\t\\t\\t</button>\\r\\n\\t\\t\\t\\t\\t\\t\\t\\t<button type=\"button\" class=\"btn btn-danger btn-xs\" ng-click=\"item.remove()\">\\r\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t<span class=\"glyphicon glyphicon-trash\"></span> Remove\\r\\n\\t\\t\\t\\t\\t\\t\\t\\t</button>\\r\\n\\t\\t\\t\\t\\t\\t\\t</td>\\r\\n\\t\\t\\t\\t\\t\\t</tr>\\r\\n\\t\\t\\t\\t\\t</tbody>\\r\\n\\t\\t\\t\\t</table>\\r\\n\\t\\t\\t\\t\\r\\n\\t\\t\\t\\t<div>\\r\\n\\t\\t\\t\\t\\t<div>\\r\\n\\t\\t\\t\\t\\t\\tQueue progress:\\r\\n\\t\\t\\t\\t\\t\\t<div class=\"progress\">\\r\\n\\t\\t\\t\\t\\t\\t\\t<div class=\"progress-bar\" role=\"progressbar\" ng-style=\"{ \\'width\\': uploader.progress + \\'%\\' }\"></div>\\r\\n\\t\\t\\t\\t\\t\\t</div>\\r\\n\\t\\t\\t\\t\\t</div>\\r\\n\\t\\t\\t\\t\\t<button type=\"button\" class=\"btn btn-success btn-sm\" ng-click=\"uploader.uploadAll()\" ng-disabled=\"!uploader.getNotUploadedItems().length\">\\r\\n\\t\\t\\t\\t\\t\\t<span class=\"glyphicon glyphicon-upload\"></span> Upload all\\r\\n\\t\\t\\t\\t\\t</button>\\r\\n\\t\\t\\t\\t\\t<button type=\"button\" class=\"btn btn-warning btn-sm\" ng-click=\"uploader.cancelAll()\" ng-disabled=\"!uploader.isUploading\">\\r\\n\\t\\t\\t\\t\\t\\t<span class=\"glyphicon glyphicon-ban-circle\"></span> Cancel all\\r\\n\\t\\t\\t\\t\\t</button>\\r\\n\\t\\t\\t\\t\\t<button type=\"button\" class=\"btn btn-danger btn-sm\" ng-click=\"uploader.clearQueue()\" ng-disabled=\"!uploader.queue.length\">\\r\\n\\t\\t\\t\\t\\t\\t<span class=\"glyphicon glyphicon-trash\"></span> Remove all\\r\\n\\t\\t\\t\\t\\t</button>\\r\\n\\t\\t\\t\\t</div>\\t\\r\\n\\t\\t\\t</div>\\r\\n\\t\\t</div>\\r\\n\\t</fieldset>\\r\\n</div>');\n$templateCache.put('app/src/importer/menu-item.html','<a ng-href=\"#/ext/importer/\">\\r\\n    <span class=\"glyphicon glyphicon-upload\"></span><span> Population importer</span>\\r\\n</a>');\n$templateCache.put('app/src/navbar/navigationBar.html','<nav class=\"navbar navbar-default\" role=\"navigation\" ng-controller=\"NavigationBarController\" cg-busy=\"{promise:loadingNavBar}\">\\r\\n    <div id=\"navbar-wrapper\" class=\"container\">\\r\\n        <ul class=\"nav navbar-nav\" id=\"navbar-interfaces\" my-navbar-resize>\\r\\n            <li><a href=\"#/\"><span class=\"glyphicon glyphicon-home\"></span></a></li>\\r\\n            <li id=\"navbar-interfaces-dropdown\" class=\"dropdown\" uib-tooltip=\"More interfaces\" tooltip-trigger=\"mouseenter\" tooltip-placement=\"top\">\\r\\n                <a href=\"\" class=\"dropdown-toggle\" data-toggle=\"dropdown\"><span class=\"glyphicon glyphicon-menu-hamburger\"></span></a>\\r\\n                <ul id=\"navbar-interfaces-dropdown-menu\" class=\"dropdown-menu\" role=\"menu\"></ul>\\r\\n            </li>\\r\\n            <li id=\"{{interface.label}}\" ng-repeat=\"interface in navbar.top\"> <!-- the interface id is there so we can style specific menu items with css -->\\r\\n                <a href=\"#/{{interface.id}}\">\\r\\n                    <span class=\"glyphicon glyphicon-list-alt\"></span> {{interface.label}}</a>\\r\\n            </li>\\r\\n        </ul>\\r\\n        <ul class=\"nav navbar-nav navbar-right\" id=\"navbar-options\">\\r\\n            <!-- hidden on extra small devices, e.g. phone (<768px) -->\\r\\n            <li class=\"dropdown hidden-xs\" uib-tooltip=\"Show/hide notifications\" tooltip-trigger=\"mouseenter\" tooltip-placement=\"left\">\\r\\n                <a href=\"\" class=\"dropdown-toggle\" data-toggle=\"dropdown\"><span class=\"glyphicon glyphicon-bullhorn\"></span></a>\\r\\n                <ul class=\"dropdown-menu\" role=\"menu\" ng-click=\"$event.stopPropagation();\">\\r\\n                    <li class=\"dropdown-header\">Transaction settings</li>\\r\\n                        <li><switch ng-model=\"$storage.notificationPrefs.switchShowSignals\"> Show signals</switch></li>\\r\\n                        <li><switch ng-model=\"$storage.notificationPrefs.switchShowInvariants\"> Show invariants</switch></li>\\r\\n                        <li><switch ng-model=\"$storage.switchAutoSave\"> Auto save changes</switch></li>\\r\\n                    <li class=\"dropdown-header\">User logs</li>\\r\\n                        <li><switch ng-model=\"$storage.notificationPrefs.switchShowErrors\"> Show errors</switch></li>\\r\\n                        <li><switch ng-model=\"$storage.notificationPrefs.switchShowWarnings\"> Show warnings</switch></li>\\r\\n                        <li><switch ng-model=\"$storage.notificationPrefs.switchShowInfos\"> Show infos</switch></li>\\r\\n                        <li><switch ng-model=\"$storage.notificationPrefs.switchShowSuccesses\"> Show successes</switch></li>\\r\\n                        <li><switch ng-model=\"$storage.notificationPrefs.switchAutoHideSuccesses\"> Auto hide successes</switch></li>\\r\\n                    <li class=\"divider\" role=\"presentation\"></li>\\r\\n                        <li><a href=\"\" ng-click=\"resetSettings();\"><span class=\"glyphicon glyphicon-repeat\" style=\"margin: 4px; width: 30px;\"></span> Default settings</a></li>\\r\\n                </ul>\\r\\n            </li>\\r\\n            \\r\\n            <!-- hidden on extra small devices, e.g. phone (<768px) -->\\r\\n            <li class=\"dropdown hidden-xs\" uib-tooltip=\"Refresh/reset options\" tooltip-trigger=\"mouseenter\" tooltip-placement=\"top\">\\r\\n                <a href=\"\" class=\"dropdown-toggle\" data-toggle=\"dropdown\"><span class=\"glyphicon glyphicon-refresh\"></span></a>\\r\\n                <ul class=\"dropdown-menu\" role=\"menu\">\\r\\n                    <li><a href=\"\" ng-click=\"reload()\"><span class=\"glyphicon glyphicon-refresh\"></span> Refresh page</a></li>\\r\\n                    <li ng-if=\"navbar.refreshMenu.length\" class=\"divider\" role=\"presentation\"></li>\\r\\n                    <li ng-repeat=\"app in navbar.refreshMenu\" ng-include=\"app.url\"/>\\r\\n                </ul>\\r\\n            </li>\\r\\n            \\r\\n            <!-- hidden on extra small devices, e.g. phone (<768px) -->\\r\\n            <li ng-if=\"navbar.extMenu.length\" class=\"dropdown hidden-xs\" uib-tooltip=\"Select application extensions\" tooltip-trigger=\"mouseenter\" tooltip-placement=\"top\">\\r\\n                <a href=\"\" class=\"dropdown-toggle\" data-toggle=\"dropdown\"><span class=\"glyphicon glyphicon-th\"></span></a>\\r\\n                <ul class=\"dropdown-menu\" role=\"menu\">\\r\\n                    <li ng-repeat=\"ext in navbar.extMenu\" ng-include=\"ext.url\"/>\\r\\n                    <!-- <li class=\"divider\" role=\"presentation\"></li>-->                    \\r\\n                </ul>\\r\\n            </li>\\r\\n            \\r\\n            <!-- hidden on extra small devices, e.g. phone (<768px) -->\\r\\n            <li ng-if=\"navbar.new.length\" class=\"dropdown hidden-xs\" uib-tooltip=\"Create new resource\" tooltip-trigger=\"mouseenter\" tooltip-placement=\"top\">\\r\\n                <a href=\"\" class=\"dropdown-toggle\" data-toggle=\"dropdown\">\\r\\n                    <span class=\"glyphicon glyphicon-plus\"></span>\\r\\n                </a>\\r\\n                <ul class=\"dropdown-menu\" role=\"menu\">\\r\\n                    <li ng-repeat=\"item in navbar.new\" ng-class=\"{\\'dropdown-submenu\\' : item.ifcs.length > 1}\">\\r\\n                        <!--<a  style=\"position:relative; display:inline-block;\">-->\\r\\n                        <a ng-if=\"item.ifcs.length > 1\" tabindex=\"-1\" href=\"#\">{{item.label}}</a>\\r\\n                        <ul ng-if=\"item.ifcs.length > 1\" class=\"dropdown-menu\" role=\"menu\">\\r\\n                            <li ng-repeat=\"ifc in item.ifcs\">\\r\\n                                <a tabindex=\"-1\" href=\"#\" ng-click=\"createNewResource(ifc.resourceType, ifc.link);\">{{ifc.label}}</a>\\r\\n                            </li>\\r\\n                        </ul>\\r\\n                        \\r\\n                        <a ng-if=\"item.ifcs.length == 1\" href=\"\" ng-click=\"createNewResource(item.ifcs[0].resourceType, item.ifcs[0].link);\">{{item.label}}</a>\\r\\n                        <span ng-if=\"item.ifcs.length == 0\">{{item.label}}</span>\\r\\n                    </li>\\r\\n                </ul>\\r\\n            </li>\\r\\n            \\r\\n            <li ng-if=\"$sessionStorage.sessionRoles.length || navbar.roleMenu.length\" class=\"dropdown\" uib-tooltip=\"Switch roles\" tooltip-trigger=\"mouseenter\" tooltip-placement=\"top\">\\r\\n                <a href=\"\" class=\"dropdown-toggle\" data-toggle=\"dropdown\"><span class=\"glyphicon glyphicon-user\"></span></a>\\r\\n                <ul class=\"dropdown-menu\" role=\"menu\">\\r\\n                    <li ng-repeat=\"role in $sessionStorage.sessionRoles\" ng-click=\"$event.stopPropagation();\"><switch ng-model=\"role.active\" ng-click=\"toggleRole(role.id);\"> {{role.label}}</switch></li>\\r\\n                    <li ng-if=\"navbar.roleMenu.length && $sessionStorage.sessionRoles.length\" class=\"divider\" role=\"presentation\"></li>\\r\\n                    <li ng-repeat=\"ext in navbar.roleMenu\" ng-include=\"ext.url\"/>\\r\\n                </ul>\\r\\n            </li>\\r\\n        </ul>\\r\\n    </div>\\r\\n</nav>');\n$templateCache.put('app/src/notifications/notificationCenter.html','<div class=\"container-fluid\">\\r\\n    <div id=\"notificationCenter\" ng-controller=\"NotificationCenterController\">\\r\\n        \\r\\n        <div id=\"infos\" ng-show=\"localStorage.notificationPrefs.switchShowInfos\">\\r\\n            <div class=\"alert alert-info alert-dismissible\" role=\"alert\" ng-repeat=\"info in notifications.infos\">\\r\\n                <button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\" ng-click=\"closeAlert(notifications.infos, $index);\"><span aria-hidden=\"true\">&times;</span></button>\\r\\n                <span class=\"glyphicon glyphicon-info-sign\"></span><span> {{info.message}}</span>\\r\\n            </div>\\r\\n        </div>\\r\\n        \\r\\n        <div id=\"warnings\" ng-show=\"localStorage.notificationPrefs.switchShowWarnings\">\\r\\n            <div class=\"alert alert-warning alert-dismissible\" role=\"alert\" ng-repeat=\"warning in notifications.warnings\">\\r\\n                <button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\" ng-click=\"closeAlert(notifications.warnings, $index);\"><span aria-hidden=\"true\">&times;</span></button>\\r\\n                <span class=\"glyphicon glyphicon-warning-sign\"></span><span> {{warning.message}}</span>\\r\\n                <span class=\"badge pull-right\" ng-show=\"warning.count > 1\">{{warning.count}}</span>\\r\\n            </div>\\r\\n        </div>\\r\\n        \\r\\n        <div id=\"errors\" ng-show=\"localStorage.notificationPrefs.switchShowErrors\">\\r\\n            <div class=\"panel panel-danger\" id=\"error-panel-{{key}}\" ng-repeat=\"(key, error) in notifications.errors\">\\r\\n                <div class=\"panel-heading btn btn-block\" data-toggle=\"collapse\" data-target=\"#error-body-{{key}}\">\\r\\n                    <div class=\"text-left\">\\r\\n                        <span class=\"glyphicon glyphicon-exclamation-sign\"></span> <span ng-bind-html=\"error.message | unsafe\"></span>\\r\\n                        <button type=\"button\" class=\"close\" data-target=\"#error-panel-{{key}}\" data-dismiss=\"alert\" aria-label=\"Dismiss\" ng-click=\"closeAlert(notifications.errors, $index);\">\\r\\n                            <span aria-hidden=\"true\">&times;</span>\\r\\n                        </button>\\r\\n                        <span class=\"badge pull-right\" ng-show=\"error.count > 1\">{{error.count}}</span>\\r\\n                    </div>\\r\\n                </div>\\r\\n                <div class=\"panel-body collapse\" id=\"error-body-{{key}}\">\\r\\n                    <div ng-if=\"error.details\" ng-bind-html=\"error.details | unsafe\"></div>\\r\\n                </div>\\r\\n            </div>\\r\\n        </div>\\r\\n        \\r\\n        <div id=\"invariants\" ng-show=\"localStorage.notificationPrefs.switchShowInvariants\">\\r\\n            <div class=\"panel panel-danger\" ng-repeat=\"(key, val) in notifications.invariants\">\\r\\n                <div class=\"panel-heading btn btn-block\" data-toggle=\"collapse\" data-target=\"#invariant-{{key}}\">\\r\\n                    <div class=\"text-left\" style=\"display:flex; align-items:center;\">\\r\\n                        <span class=\"glyphicon glyphicon-warning-sign\"></span>\\r\\n                        <div marked=\"val.ruleMessage\" style=\"display:inline-block; margin: 0px 10px;\"></div> <!-- uses angular-marked directive -->\\r\\n                        <span class=\"badge\" style=\"margin-left:auto;\">{{val.tuples.length}}</span>\\r\\n                    </div>\\r\\n                </div>\\r\\n                <ul class=\"list-group collapse\" id=\"invariant-{{key}}\">\\r\\n                    <li class=\"list-group-item\" ng-repeat=\"tuple in val.tuples track by $index\">\\r\\n                        <span>{{tuple.violationMessage}}</span>\\r\\n                    </li>\\r\\n                </ul>\\r\\n            </div>\\r\\n        </div>\\r\\n                    \\r\\n        <div id=\"signals\" ng-show=\"localStorage.notificationPrefs.switchShowSignals\">\\r\\n            <div class=\"panel panel-warning\" ng-repeat=\"(key, val) in notifications.signals\">\\r\\n                <div class=\"panel-heading btn btn-block\" data-toggle=\"collapse\" data-target=\"#violation-{{key}}\">\\r\\n                    <div class=\"text-left\" style=\"display:flex; align-items:center;\">\\r\\n                        <span class=\"glyphicon glyphicon-warning-sign\"></span>\\r\\n                        <div marked=\"val.message\" style=\"display:inline-block; margin: 0px 10px;\"></div> <!-- uses angular-marked directive -->\\r\\n                        <span class=\"badge\" style=\"margin-left:auto;\">{{val.violations.length}}</span>\\r\\n                    </div>\\r\\n                </div>\\r\\n                <ul class=\"list-group collapse\" id=\"violation-{{key}}\">\\r\\n                    <li class=\"dropdown list-group-item\" ng-repeat=\"violation in val.violations track by $index\">\\r\\n                        <div ng-if=\"violation.ifcs.length > 1\">\\r\\n                            <a href=\"\" class=\"dropdown-toggle\" data-toggle=\"dropdown\">{{violation.message}}</a>\\r\\n                            <ul class=\"dropdown-menu\" role=\"menu\">\\r\\n                                <li ng-repeat=\"ifc in violation.ifcs\">\\r\\n                                    <a ng-href=\"{{ifc.link}}\" data-toggle=\"collapse\" data-target=\"#violation-{{key}}\"><small>View</small> {{ifc.label}}</a>\\r\\n                                </li>\\r\\n                            </ul>\\r\\n                        </div>\\r\\n                        <a ng-if=\"violation.ifcs.length == 1\" ng-href=\"{{violation.ifcs[0].link}}\" data-toggle=\"collapse\" data-target=\"#violation-{{key}}\">{{violation.message}}</a>\\r\\n                        <span ng-if=\"violation.ifcs.length == 0\">{{violation.message}}</span>\\r\\n                    </li>\\r\\n                </ul>\\r\\n            </div>\\r\\n        </div>\\r\\n        \\r\\n        <!-- Success notifications must be last in notifications center because of position:absolute -->\\r\\n        <div id=\"successes\" ng-show=\"localStorage.notificationPrefs.switchShowSuccesses\">\\r\\n            <div class=\"alert alert-success alert-dismissible\" role=\"alert\" ng-repeat=\"success in notifications.successes\">\\r\\n                <button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\" ng-click=\"closeAlert(notifications.successes, $index);\"><span aria-hidden=\"true\">&times;</span></button>\\r\\n                <span class=\"glyphicon glyphicon-ok-sign\"></span><span> {{success.message}}</span>\\r\\n            </div>\\r\\n        </div>\\r\\n    </div>\\r\\n</div>');\n$templateCache.put('app/src/shared/404.html','<!-- 404 page -->\\r\\n<div class=\"container-fluid\" id=\"Interface\">\\r\\n    <div class=\"row\">\\r\\n        <div class=\"col-md-4\">\\r\\n            <h1>404 Page not found</h1>\\r\\n            <p>The requested page does not exists.</p>\\r\\n            <p><a class=\"btn btn-primary btn-lg\" href=\"#/\" role=\"button\">Goto startpage</a></p>\\r\\n        </div>\\r\\n        <div>\\r\\n            <img src=\"app/images/404-image.png\">\\r\\n        </div>\\r\\n    </div>\\r\\n</div>');\n$templateCache.put('app/src/shared/home.html','<!-- Home screen -->\\r\\n<div class=\"container-fluid\" id=\"Interface\">\\r\\n    <div class=\"jumbotron\">\\r\\n        <h1>Hello, world!</h1>\\r\\n        <p>You\\'ve successfully generated your Ampersand prototype.</p>\\r\\n        <p><a class=\"btn btn-primary btn-lg\" href=\"https://ampersandtarski.gitbooks.io/documentation\" target=\"_blank\" role=\"button\">See our documentation &raquo;</a></p>\\r\\n    </div>\\r\\n</div>\\r\\n');\n$templateCache.put('app/src/shared/myNavTo/myNavToInterfaces.html','<div ng-if=\"resource._ifcs_.length > 1\" style=\"position:relative; display:inline-block;\">\\r\\n    <a class=\"dropdown-toggle\" data-toggle=\"dropdown\"><ng-transclude></ng-transclude></a>\\r\\n    <ul class=\"dropdown-menu\" role=\"menu\">\\r\\n        <li ng-repeat=\"ifc in resource._ifcs_\">\\r\\n            <a ng-href=\"#/{{ifc.id}}/{{resource._id_}}\" target=\"{{target}}\">{{ifc.label}}</a>\\r\\n        </li>\\r\\n    </ul>\\r\\n</div>\\r\\n<a ng-if=\"resource._ifcs_.length == 1\" ng-href=\"#/{{resource._ifcs_[0].id}}/{{resource._id_}}\" target=\"{{target}}\"><ng-transclude></ng-transclude></a>\\r\\n<span ng-if=\"resource._ifcs_.length == 0 || resource._ifcs_ == undefined\"><ng-transclude></ng-transclude></span>');\n$templateCache.put('app/src/shared/myNavTo/myNavToOtherInterfaces.html','<!-- Only when ifcs has more than 1 interface, otherwise, the user is already there -->\\r\\n<!-- This menu includes the interface where the user currently is -->\\r\\n<div ng-if=\"resource._ifcs_.length > 1\" style=\"position:relative;\">\\r\\n    <button type=\"button\" class=\"btn btn-sm dropdown-toggle\" data-toggle=\"dropdown\">\\r\\n        <span class=\"glyphicon glyphicon-menu-hamburger\"></span>\\r\\n    </button>\\r\\n    <ul class=\"dropdown-menu dropdown-menu-right\" role=\"menu\">\\r\\n        <li ng-repeat=\"ifc in resource._ifcs_\">\\r\\n            <a ng-href=\"#/{{ifc.id}}/{{resource._id_}}\" target=\"{{target}}\">{{ifc.label}}</a>\\r\\n        </li>\\r\\n    </ul>\\r\\n</div>');\n$templateCache.put('app/src/shared/loading/loading.html','<img src=\"app/images/loading.gif\" alt=\"Loading...\" style=\"height:20px;\"/>');}]);",null]}